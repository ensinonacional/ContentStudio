<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Criar Curso - ContentStudio</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="../css/styles.css">
    <script src="../js/auth-block.js"></script>
    <style>
        .modulo-card {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: var(--radius-xl);
            margin-bottom: 24px;
            overflow: hidden;
        }

        .modulo-header {
            background: var(--gradient-primary);
            padding: 18px 24px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modulo-title {
            font-size: 1.1rem;
            font-weight: 700;
            color: white;
        }

        .modulo-badge {
            background: rgba(255,255,255,0.2);
            padding: 6px 14px;
            border-radius: var(--radius-lg);
            font-size: 0.85rem;
            color: white;
        }

        .modulo-body {
            padding: 24px;
        }

        .aula-item {
            display: flex;
            align-items: flex-start;
            gap: 16px;
            padding: 16px;
            background: var(--bg-tertiary);
            border-radius: var(--radius-md);
            margin-bottom: 12px;
        }

        .aula-item:last-child {
            margin-bottom: 0;
        }

        .aula-icon {
            width: 44px;
            height: 44px;
            border-radius: var(--radius-md);
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
            font-size: 1.2rem;
        }

        .aula-icon.reels {
            background: linear-gradient(135deg, #f59e0b, #ef4444);
        }

        .aula-icon.texto {
            background: linear-gradient(135deg, #3b82f6, #06b6d4);
        }

        .aula-icon.carrossel {
            background: linear-gradient(135deg, #ec4899, #8b5cf6);
        }

        .aula-icon.quiz {
            background: linear-gradient(135deg, #10b981, #059669);
        }

        .aula-content {
            flex: 1;
        }

        .aula-title {
            font-weight: 600;
            margin-bottom: 4px;
        }

        .aula-desc {
            font-size: 0.9rem;
            color: var(--text-secondary);
            margin-bottom: 8px;
        }

        .aula-meta {
            display: flex;
            gap: 12px;
            font-size: 0.8rem;
            color: var(--text-muted);
        }

        .aula-meta span {
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .quiz-item {
            background: var(--accent-glow);
            border: 1px solid var(--accent);
            padding: 16px;
            border-radius: var(--radius-md);
            margin-top: 16px;
        }

        .quiz-title {
            font-weight: 600;
            color: var(--accent-light);
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .quiz-question {
            background: var(--bg-secondary);
            padding: 12px 16px;
            border-radius: var(--radius-sm);
            margin-bottom: 8px;
            font-size: 0.9rem;
        }

        .quiz-question:last-child {
            margin-bottom: 0;
        }

        .curso-summary {
            background: var(--gradient-card);
            border: 1px solid var(--border);
            border-radius: var(--radius-xl);
            padding: 24px;
            margin-bottom: 24px;
        }

        .summary-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
            gap: 16px;
            margin-top: 16px;
        }

        .stat-item {
            text-align: center;
            padding: 16px;
            background: var(--bg-tertiary);
            border-radius: var(--radius-md);
        }

        .stat-value {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--accent-light);
        }

        .stat-label {
            font-size: 0.75rem;
            color: var(--text-muted);
            margin-top: 4px;
        }

        .topicos-input {
            margin-top: 12px;
        }

        .topico-item {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 10px;
        }

        .topico-item input {
            flex: 1;
        }

        .topico-item button {
            padding: 8px;
            background: var(--bg-tertiary);
            border: 1px solid var(--border);
            border-radius: var(--radius-sm);
            cursor: pointer;
            color: var(--text-muted);
        }

        .topico-item button:hover {
            background: var(--error);
            color: white;
            border-color: var(--error);
        }

        .add-topico-btn {
            width: 100%;
            padding: 12px;
            background: var(--bg-tertiary);
            border: 2px dashed var(--border);
            border-radius: var(--radius-md);
            cursor: pointer;
            color: var(--text-muted);
            font-size: 0.9rem;
            transition: all 0.2s;
        }

        .add-topico-btn:hover {
            border-color: var(--accent);
            color: var(--accent-light);
        }
    </style>
</head>
<body>
    <div class="page-container">
        <!-- Hero -->
        <section class="hero" style="padding: 40px 0;">
            <h1 class="hero-title" style="font-size: 2.5rem;">Criar Curso</h1>
            <p class="hero-subtitle">Crie cursos completos divididos em modulos com Reels, carrosseis, textos e quizzes</p>
        </section>

        <!-- Config -->
        <div class="card mb-3">
            <div class="config-row">
                <div class="config-group">
                    <label class="config-label">Nome do Curso</label>
                    <input type="text" id="nomeCurso" placeholder="Ex: Dominando o Marketing Digital">
                </div>
                <div class="config-group">
                    <label class="config-label">Publico-alvo</label>
                    <input type="text" id="publicoAlvo" placeholder="Ex: Empreendedores iniciantes">
                </div>
            </div>

            <div class="form-group mt-2">
                <label class="form-label">Objetivo do curso</label>
                <textarea id="objetivoCurso" style="min-height: 80px;" placeholder="O que o aluno vai conseguir fazer apos completar o curso?"></textarea>
            </div>

            <div class="form-group mt-2">
                <label class="form-label">üìÑ Conteudo completo do modulo/curso <span style="color: var(--text-muted); font-weight: normal;">(opcional - cole aqui o texto que sera transformado em videos)</span></label>
                <textarea id="conteudoCompleto" style="min-height: 150px;" placeholder="Cole aqui o texto completo do seu modulo ou curso. A IA vai analisar todo esse conteudo e dividir em videos curtos, identificando os pontos mais importantes e transformando em roteiros diretos e com conteudo de valor real.

Exemplo: Cole aqui um capitulo de ebook, transcricao de aula, apostila, etc."></textarea>
            </div>

            <div class="form-group mt-2">
                <label class="form-label">Topicos principais <span style="color: var(--text-muted); font-weight: normal;">(use se nao colou conteudo acima)</span></label>
                <div class="topicos-input" id="topicosContainer">
                    <div class="topico-item">
                        <input type="text" class="topico-input" placeholder="Topico 1">
                        <button onclick="removerTopico(this)">‚úï</button>
                    </div>
                    <div class="topico-item">
                        <input type="text" class="topico-input" placeholder="Topico 2">
                        <button onclick="removerTopico(this)">‚úï</button>
                    </div>
                    <div class="topico-item">
                        <input type="text" class="topico-input" placeholder="Topico 3">
                        <button onclick="removerTopico(this)">‚úï</button>
                    </div>
                </div>
                <button class="add-topico-btn" onclick="adicionarTopico()">+ Adicionar topico</button>
            </div>

            <div class="config-row mt-3">
                <div class="config-group">
                    <label class="config-label">Numero de modulos</label>
                    <div class="input-row">
                        <input type="number" id="numModulos" value="1" min="1" max="10">
                        <span class="input-suffix">modulos</span>
                    </div>
                </div>
                <div class="config-group">
                    <label class="config-label">Videos por modulo</label>
                    <div class="input-row">
                        <input type="number" id="videosPorModulo" value="5" min="3" max="15">
                        <span class="input-suffix">videos</span>
                    </div>
                </div>
                <div class="config-group">
                    <label class="config-label">Nivel de profundidade</label>
                    <select id="nivel">
                        <option value="basico">Basico - Iniciantes</option>
                        <option value="intermediario">Intermediario</option>
                        <option value="avancado">Avancado</option>
                    </select>
                </div>
                <div class="config-group">
                    <label class="config-label">Incluir quiz</label>
                    <select id="incluirQuiz">
                        <option value="nao">Nao incluir quiz</option>
                        <option value="sim">Sim, ao final de cada modulo</option>
                    </select>
                </div>
            </div>

            <div class="config-row mt-2">
                <div class="config-group">
                    <label class="config-label">Estilo do roteiro</label>
                    <div style="display: flex; flex-direction: column; gap: 8px; margin-top: 8px;">
                        <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
                            <input type="checkbox" id="semGancho" checked style="width: 18px; height: 18px;">
                            <span>Sem Gancho (comecar direto no conteudo)</span>
                        </label>
                        <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
                            <input type="checkbox" id="semCTA" checked style="width: 18px; height: 18px;">
                            <span>Sem CTA (terminar quando o conteudo terminar)</span>
                        </label>
                    </div>
                </div>
            </div>

            <button class="btn btn-primary btn-lg mt-3" onclick="gerarCurso()">
                <svg viewBox="0 0 24 24" width="20" height="20"><path d="M18 2H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zM6 4h5v8l-2.5-1.5L6 12V4z"/></svg>
                Gerar Estrutura do Curso
            </button>
        </div>

        <!-- Output -->
        <div id="outputArea">
            <div class="card">
                <div class="output-placeholder">
                    <svg viewBox="0 0 24 24"><path d="M18 2H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zM6 4h5v8l-2.5-1.5L6 12V4z"/></svg>
                    <p>A estrutura do seu curso aparecera aqui</p>
                </div>
            </div>
        </div>
    </div>

    <script src="../js/common.js"></script>
    <script>
        // Renderizar header
        renderHeader('criar-curso');

        function adicionarTopico() {
            const container = document.getElementById('topicosContainer');
            const count = container.querySelectorAll('.topico-item').length + 1;
            const div = document.createElement('div');
            div.className = 'topico-item';
            div.innerHTML = `
                <input type="text" class="topico-input" placeholder="Topico ${count}">
                <button onclick="removerTopico(this)">‚úï</button>
            `;
            container.appendChild(div);
        }

        function removerTopico(btn) {
            const container = document.getElementById('topicosContainer');
            if (container.querySelectorAll('.topico-item').length > 1) {
                btn.parentElement.remove();
            }
        }

        function toggleRoteiro(id) {
            const el = document.getElementById(id);
            const btn = event.target;
            if (el.style.display === 'none') {
                el.style.display = 'block';
                btn.textContent = 'Ocultar Roteiro ‚ñ≤';
            } else {
                el.style.display = 'none';
                btn.textContent = 'Ver Roteiro ‚ñº';
            }
        }

        function copiarRoteiro(id) {
            const texto = document.getElementById(id).innerText;
            navigator.clipboard.writeText(texto).then(() => {
                mostrarNotificacao('Roteiro copiado!', 'success');
            });
        }

        async function gerarCurso() {
            const nomeCurso = document.getElementById('nomeCurso').value.trim();
            const publicoAlvo = document.getElementById('publicoAlvo').value.trim();
            const objetivoCurso = document.getElementById('objetivoCurso').value.trim();
            const conteudoCompleto = document.getElementById('conteudoCompleto').value.trim();
            const numModulos = parseInt(document.getElementById('numModulos').value);
            const videosPorModulo = parseInt(document.getElementById('videosPorModulo').value);
            const nivel = document.getElementById('nivel').value;
            const incluirQuiz = document.getElementById('incluirQuiz').value === 'sim';
            const semGancho = document.getElementById('semGancho').checked;
            const semCTA = document.getElementById('semCTA').checked;

            const topicos = Array.from(document.querySelectorAll('.topico-input'))
                .map(input => input.value.trim())
                .filter(t => t);

            const outputArea = document.getElementById('outputArea');

            if (!nomeCurso) {
                outputArea.innerHTML = `
                    <div class="card">
                        <div class="output-placeholder">
                            <svg viewBox="0 0 24 24" style="fill: var(--warning);"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z"/></svg>
                            <p>Preencha pelo menos o nome do curso</p>
                        </div>
                    </div>
                `;
                return;
            }

            if (!APIConfig.key) {
                outputArea.innerHTML = `
                    <div class="card">
                        <div class="output-placeholder">
                            <svg viewBox="0 0 24 24" style="fill: var(--error);"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z"/></svg>
                            <p style="color: var(--error);">API nao configurada</p>
                        </div>
                    </div>
                `;
                return;
            }

            // Loading
            outputArea.innerHTML = `
                <div class="card">
                    <div class="output-placeholder">
                        <div class="loading" style="font-size: 3rem;">üìö</div>
                        <p>Gerando estrutura do curso...</p>
                    </div>
                </div>
            `;

            const systemPrompt = `Voce e um PROFESSOR ESPECIALISTA e PESQUISADOR que transforma textos academicos/tecnicos em videos curtos de alto impacto.

SUA MISSAO:
O aluno ja leu o texto escrito com os detalhes tecnicos (nomes, datas, criadores, historico). Agora voce precisa criar roteiros de video que COMPLEMENTAM esse texto, trazendo:
- O que e REALMENTE interessante sobre o assunto
- Curiosidades que poucos sabem
- Conexoes surpreendentes
- O "por que isso importa" de verdade
- Contexto que enriquece o entendimento
- Informacoes relevantes que podem ter sido esquecidas no texto original

VOCE TEM LIBERDADE PARA:
- Trazer informacoes adicionais relevantes que complementam o texto
- Fazer conexoes interessantes que o texto nao fez
- Explicar de forma mais envolvente o mesmo conceito
- Adicionar curiosidades verdadeiras sobre o tema
- Dar exemplos praticos do dia a dia

REGRAS ABSOLUTAS:

1. FIDELIDADE AO ASSUNTO:
- NUNCA saia do tema principal
- Tudo que disser deve ser VERDADEIRO e verificavel
- Complemente, mas nao contradiga o texto base
- Mantenha a veracidade acima de tudo

2. CONTEUDO QUE SURPREENDE:
- O aluno ja sabe o basico (leu o texto)
- Traga algo que faca ele pensar "nossa, eu nao sabia disso!"
- Evite repetir exatamente o que esta no texto - ENRIQUECA
- Foque no que e fascinante, relevante e pouco conhecido

3. ZERO ENROLACAO:
- Comece DIRETO no conteudo interessante
- Nada de introducoes longas
- Nada de "nesse video eu vou te ensinar..."
- Va direto ao ponto que importa

4. TOM DE PROFESSOR APAIXONADO:
- Fale como alguem que AMA o assunto
- Natural, como uma conversa
- Sem bordoes ou frases feitas
- Linguagem acessivel mas precisa

5. FORMATO DO ROTEIRO:
- Texto UNICO e CONTINUO
- Paragrafos indicam pausas
- PROIBIDO: labels, divisoes, bullet points
- Escreva exatamente como a pessoa vai FALAR

6. TITULOS COM POSICIONAMENTO:
- Use prefixos: "[ABERTURA]", "[FUNDAMENTO]", "[APROFUNDANDO]", "[NA PRATICA]", "[FECHAMENTO]"
- O titulo deve indicar ONDE o video se encaixa

Sempre responda em portugues brasileiro.
Retorne APENAS o JSON solicitado, sem markdown.`;

            const userPrompt = `ANALISE O CONTEUDO ABAIXO E TRANSFORME EM UM CURSO DE VIDEOS CURTOS:

INFORMACOES DO CURSO:
- Nome: ${nomeCurso}
- Publico-alvo: ${publicoAlvo || 'Geral'}
- Objetivo: ${objetivoCurso || 'Nao especificado'}
- Topicos principais: ${topicos.length > 0 ? topicos.join(', ') : 'A definir baseado no conteudo'}

${conteudoCompleto ? `TEXTO BASE DO CURSO (o aluno ja leu isso):
"""
${conteudoCompleto}
"""

INSTRUCAO ESPECIAL:
- O aluno JA LEU esse texto acima com os detalhes tecnicos, nomes, datas, etc.
- Seu trabalho e criar roteiros que COMPLEMENTAM e ENRIQUECEM esse texto
- NAO repita o obvio - traga o que e INTERESSANTE e SURPREENDENTE
- Pode adicionar informacoes relevantes que o texto nao mencionou
- Faca conexoes que o texto nao fez
- Explique o "por que isso importa" de verdade
- MANTENHA A VERACIDADE - tudo deve ser verdadeiro e relacionado ao tema
` : ''}
CONFIGURACOES:
- Numero de modulos: ${numModulos}
- Videos por modulo: ${videosPorModulo}
- Nivel: ${nivel}
- Incluir quiz: ${incluirQuiz ? 'Sim' : 'Nao'}

METODOLOGIA DE DIVISAO:
1. Analise TODO o conteudo fornecido
2. Identifique os conceitos-chave que REALMENTE importam
3. Divida em ${numModulos} modulos logicos
4. Cada modulo deve ter EXATAMENTE ${videosPorModulo} videos
5. Os videos devem cobrir: abertura do tema, fundamentos, aprofundamento, pratica e fechamento
6. IMPORTANTE: Distribua o conteudo de forma que cada video tenha substancia real

FORMATO DOS VIDEOS:
- REELS (30-60s): Diretos, chamativos, uma ideia forte por video
- CARROSSEL (5-8 slides): Para listas, comparacoes, passo-a-passo visual
- TEXTO: Para conceitos que precisam de mais reflexao

REGRAS DOS ROTEIROS:
${semGancho ? '- SEM GANCHO: Nada de "Voce sabia que...", "Ja pensou se...", "E se eu te disser que...", perguntas retoricas - comece DIRETO no conteudo, na primeira frase ja ensine algo' : '- COM GANCHO: Pode comecar com uma pergunta ou frase de impacto para prender atencao'}
${semCTA ? '- SEM CTA: Nada de "curta", "compartilhe", "siga", "comenta aqui", "salva esse video" - termine quando o conteudo terminar, sem pedir nada' : '- COM CTA: Pode incluir chamada para acao no final'}
- Nada de "Ola pessoal" ou "E ai galera"
- Nada de "Nesse video vou te ensinar" - ja ensine
- Nada de repeticao de estruturas entre videos
- Cada video = 1 aprendizado concreto
- Tom de conversa de professor com aluno
- ${incluirQuiz ? 'Inclua 3-5 perguntas de quiz ao final de cada modulo' : 'Nao inclua quiz'}

Retorne um JSON no formato:
{
    "nome_curso": "nome",
    "descricao": "descricao breve",
    "duracao_estimada": "X horas",
    "modulos": [
        {
            "numero": 1,
            "titulo": "titulo do modulo",
            "descricao": "o que o aluno vai aprender",
            "aulas": [
                {
                    "numero": 1,
                    "titulo": "[POSICAO] Titulo descritivo",
                    "formato": "reels|texto|carrossel",
                    "duracao": "30s ou 5 min leitura ou 8 slides",
                    "descricao": "breve descricao do conteudo",
                    "roteiro": "Texto unico e continuo exatamente como a pessoa vai falar. Apenas paragrafos para pausas. SEM labels, SEM divisoes, SEM bullet points."
                }
            ],
            "quiz": ${incluirQuiz ? '[{"pergunta": "pergunta pratica sobre o conteudo", "resposta": "resposta correta"}]' : 'null'}
        }
    ]
}

REGRA CRITICA PARA O CAMPO "roteiro":
- DEVE ser texto corrido UNICO, como se fosse uma fala transcrita
- NUNCA use labels como "Gancho:", "Abertura:", "Desenvolvimento:", "CTA:", "Fechamento:"
- NUNCA divida em secoes ou partes
- NUNCA use bullet points ou numeracao
- APENAS paragrafos para indicar pausas na fala
- Escreva EXATAMENTE o que a pessoa vai falar, do inicio ao fim, sem nenhuma marcacao

Exemplo de roteiro CORRETO (complementa o texto, traz algo interessante):
"O que pouca gente sabe sobre esse assunto e que ele mudou completamente a forma como pensamos hoje. Na epoca, ninguem imaginava o impacto que isso teria.

E o mais fascinante e que a ideia surgiu de um problema completamente diferente. O criador estava tentando resolver outra coisa quando percebeu que tinha algo muito maior nas maos.

Isso explica por que ate hoje essa abordagem continua sendo a base de tudo que veio depois."

Exemplo de roteiro ERRADO (apenas repete o texto ou inventa informacoes):
"O computador foi criado por fulano em tal ano e tinha tais especificacoes..." (ERRADO - isso ja esta no texto)
"Dizem que ele fez isso sozinho em uma garagem..." (ERRADO - se nao for verdade, nao invente)

- O campo "titulo" deve comecar com a posicao entre colchetes: [ABERTURA], [FUNDAMENTO], [APROFUNDANDO], [NA PRATICA], [FECHAMENTO], [DICA EXTRA]
- Cada roteiro deve ser UNICO, sem padroes repetitivos entre eles`;

            try {
                const resposta = await chamarAPI(systemPrompt, userPrompt);
                const jsonLimpo = resposta.replace(/```json\n?/g, '').replace(/```\n?/g, '').trim();
                const dados = JSON.parse(jsonLimpo);

                // Contar aulas e formatos
                let totalAulas = 0;
                let totalReels = 0;
                let totalTexto = 0;
                let totalCarrossel = 0;

                dados.modulos.forEach(m => {
                    m.aulas.forEach(a => {
                        totalAulas++;
                        if (a.formato === 'reels') totalReels++;
                        if (a.formato === 'texto') totalTexto++;
                        if (a.formato === 'carrossel') totalCarrossel++;
                    });
                });

                let html = `
                    <div class="curso-summary">
                        <h2 style="margin: 0 0 8px 0;">${dados.nome_curso}</h2>
                        <p class="text-muted">${dados.descricao}</p>
                        <div class="summary-stats">
                            <div class="stat-item">
                                <div class="stat-value">${dados.modulos.length}</div>
                                <div class="stat-label">Modulos</div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-value">${totalAulas}</div>
                                <div class="stat-label">Aulas</div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-value">${totalReels}</div>
                                <div class="stat-label">Reels</div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-value">${totalCarrossel}</div>
                                <div class="stat-label">Carrosseis</div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-value">${totalTexto}</div>
                                <div class="stat-label">Textos</div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-value">${dados.duracao_estimada}</div>
                                <div class="stat-label">Duracao</div>
                            </div>
                        </div>
                    </div>
                `;

                dados.modulos.forEach(modulo => {
                    html += `
                        <div class="modulo-card">
                            <div class="modulo-header">
                                <span class="modulo-title">Modulo ${modulo.numero}: ${modulo.titulo}</span>
                                <span class="modulo-badge">${modulo.aulas.length} aulas</span>
                            </div>
                            <div class="modulo-body">
                                <p class="text-muted mb-3">${modulo.descricao}</p>
                    `;

                    modulo.aulas.forEach(aula => {
                        const icone = aula.formato === 'reels' ? 'üé¨' :
                                     aula.formato === 'carrossel' ? 'üé†' : 'üìù';
                        const aulaId = `aula-${modulo.numero}-${aula.numero}`;
                        html += `
                            <div class="aula-item" style="flex-direction: column; align-items: stretch;">
                                <div style="display: flex; align-items: flex-start; gap: 16px;">
                                    <div class="aula-icon ${aula.formato}">${icone}</div>
                                    <div class="aula-content" style="flex: 1;">
                                        <div class="aula-title">${aula.numero}. ${aula.titulo}</div>
                                        <div class="aula-desc">${aula.descricao}</div>
                                        <div class="aula-meta">
                                            <span>${aula.formato.toUpperCase()}</span>
                                            <span>‚è± ${aula.duracao}</span>
                                        </div>
                                    </div>
                                    <button class="btn-expand" onclick="toggleRoteiro('${aulaId}')" style="padding: 8px 12px; background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: var(--radius-sm); cursor: pointer; color: var(--text-secondary); font-size: 0.85rem;">
                                        Ver Roteiro ‚ñº
                                    </button>
                                </div>
                                ${aula.roteiro ? `
                                    <div id="${aulaId}" class="roteiro-content" style="display: none; margin-top: 16px; padding: 16px; background: var(--bg-secondary); border-radius: var(--radius-md); border-left: 3px solid var(--accent);">
                                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px;">
                                            <strong style="color: var(--accent-light);">üìú Roteiro Completo:</strong>
                                            <button onclick="copiarRoteiro('${aulaId}-texto')" style="padding: 6px 12px; background: var(--accent); color: white; border: none; border-radius: var(--radius-sm); cursor: pointer; font-size: 0.8rem;">Copiar</button>
                                        </div>
                                        <div id="${aulaId}-texto" style="white-space: pre-wrap; line-height: 1.7; color: var(--text-primary);">${aula.roteiro}</div>
                                    </div>
                                ` : ''}
                            </div>
                        `;
                    });

                    if (modulo.quiz && modulo.quiz.length > 0) {
                        html += `
                            <div class="quiz-item">
                                <div class="quiz-title">üß† Quiz do Modulo</div>
                        `;
                        modulo.quiz.forEach((q, i) => {
                            html += `<div class="quiz-question"><strong>${i + 1}.</strong> ${q.pergunta}</div>`;
                        });
                        html += `</div>`;
                    }

                    html += `
                            </div>
                        </div>
                    `;
                });

                outputArea.innerHTML = html;

            } catch (error) {
                outputArea.innerHTML = `
                    <div class="card">
                        <div class="output-placeholder">
                            <svg viewBox="0 0 24 24" style="fill: var(--error);"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z"/></svg>
                            <p style="color: var(--error);">Erro ao gerar curso</p>
                            <p class="text-muted">${error.message}</p>
                            <button onclick="gerarCurso()" class="btn btn-primary mt-2">Tentar novamente</button>
                        </div>
                    </div>
                `;
            }
        }
    </script>
</body>
</html>
