<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Roteirizador - Transforme textos em roteiros</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --bg-primary: #0f172a;
            --bg-secondary: #1e293b;
            --bg-tertiary: #334155;
            --bg-input: #1e293b;
            --bg-card: #1e293b;
            --text-primary: #f1f5f9;
            --text-secondary: #94a3b8;
            --text-muted: #64748b;
            --accent: #8b5cf6;
            --accent-light: #a78bfa;
            --accent-dark: #7c3aed;
            --accent-glow: rgba(139, 92, 246, 0.15);
            --border: #334155;
            --border-light: #475569;
            --success: #34d399;
            --warning: #fbbf24;
            --error: #f87171;
            --gradient-1: linear-gradient(135deg, #8b5cf6 0%, #06b6d4 100%);
            --gradient-2: linear-gradient(135deg, #8b5cf6 0%, #ec4899 100%);
            --shadow-sm: 0 1px 2px rgba(0,0,0,0.3);
            --shadow-md: 0 4px 12px rgba(0,0,0,0.4);
            --shadow-lg: 0 8px 30px rgba(0,0,0,0.5);
            --radius-sm: 8px;
            --radius-md: 12px;
            --radius-lg: 16px;
            --radius-xl: 24px;
        }

        [data-theme="light"] {
            --bg-primary: #f8fafc;
            --bg-secondary: #ffffff;
            --bg-tertiary: #f1f5f9;
            --bg-input: #ffffff;
            --bg-card: #ffffff;
            --text-primary: #0f172a;
            --text-secondary: #475569;
            --text-muted: #94a3b8;
            --accent: #7c3aed;
            --accent-light: #8b5cf6;
            --accent-dark: #6d28d9;
            --accent-glow: rgba(124, 58, 237, 0.1);
            --border: #e2e8f0;
            --border-light: #cbd5e1;
            --success: #10b981;
            --warning: #f59e0b;
            --error: #ef4444;
            --shadow-sm: 0 1px 2px rgba(0,0,0,0.05);
            --shadow-md: 0 4px 12px rgba(0,0,0,0.08);
            --shadow-lg: 0 8px 30px rgba(0,0,0,0.12);
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--bg-primary);
            min-height: 100vh;
            color: var(--text-primary);
            line-height: 1.6;
        }

        /* Subtle background pattern */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background:
                radial-gradient(circle at 20% 20%, var(--accent-glow) 0%, transparent 50%),
                radial-gradient(circle at 80% 80%, rgba(6, 182, 212, 0.08) 0%, transparent 50%);
            pointer-events: none;
            z-index: -1;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 24px 32px;
        }

        /* Header */
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 32px;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .logo-icon {
            width: 42px;
            height: 42px;
            background: var(--gradient-1);
            border-radius: var(--radius-md);
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 15px rgba(139, 92, 246, 0.4);
        }

        .logo-icon svg {
            width: 22px;
            height: 22px;
            fill: white;
        }

        .logo-text {
            font-size: 1.3rem;
            font-weight: 700;
            background: var(--gradient-1);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .theme-select {
            display: flex;
            align-items: center;
            gap: 10px;
            background: var(--bg-secondary);
            padding: 8px 16px;
            border-radius: var(--radius-lg);
            border: 1px solid var(--border);
        }

        .theme-select label {
            font-size: 0.85rem;
            color: var(--text-secondary);
            font-weight: 500;
        }

        .theme-select select {
            background: var(--bg-tertiary);
            border: none;
            border-radius: var(--radius-sm);
            padding: 6px 12px;
            color: var(--text-primary);
            font-size: 0.85rem;
            font-family: inherit;
            cursor: pointer;
        }

        .theme-select select:focus {
            outline: 2px solid var(--accent);
            outline-offset: 2px;
        }

        /* Hero */
        .hero {
            text-align: center;
            margin-bottom: 40px;
            padding: 20px 0;
        }

        .hero h1 {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 12px;
            background: var(--gradient-1);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .hero p {
            font-size: 1.1rem;
            color: var(--text-secondary);
            max-width: 500px;
            margin: 0 auto;
        }

        /* Config Section */
        .config-section {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: var(--radius-xl);
            padding: 28px 32px;
            margin-bottom: 24px;
            box-shadow: var(--shadow-md);
        }

        /* Tabs de Configura√ß√£o */
        .config-tabs {
            display: flex;
            gap: 8px;
            margin-bottom: 24px;
            border-bottom: 2px solid var(--border);
            padding-bottom: 0;
        }

        .config-tab {
            padding: 12px 24px;
            background: transparent;
            border: none;
            border-bottom: 3px solid transparent;
            margin-bottom: -2px;
            color: var(--text-secondary);
            font-size: 0.95rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .config-tab:hover {
            color: var(--text-primary);
        }

        .config-tab.active {
            color: var(--accent-light);
            border-bottom-color: var(--accent);
        }

        .config-tab svg {
            width: 18px;
            height: 18px;
            fill: currentColor;
        }

        .config-tab-content {
            display: none;
        }

        .config-tab-content.active {
            display: block;
            animation: fadeIn 0.3s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-5px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .config-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .config-row:last-child {
            margin-bottom: 0;
        }

        .config-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .config-group.span-2 {
            grid-column: span 2;
        }

        @media (max-width: 600px) {
            .config-group.span-2 {
                grid-column: span 1;
            }
        }

        .config-label {
            font-size: 0.8rem;
            font-weight: 600;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .config-label.highlight {
            color: var(--accent-light);
            display: flex;
            align-items: center;
            gap: 6px;
        }

        /* Form Elements */
        input[type="text"],
        input[type="number"],
        select,
        textarea {
            background: var(--bg-input);
            border: 2px solid var(--border);
            border-radius: var(--radius-md);
            padding: 12px 16px;
            color: var(--text-primary);
            font-size: 0.95rem;
            font-family: inherit;
            transition: all 0.2s ease;
        }

        input[type="text"]:hover,
        input[type="number"]:hover,
        select:hover,
        textarea:hover {
            border-color: var(--border-light);
        }

        input[type="text"]:focus,
        input[type="number"]:focus,
        select:focus,
        textarea:focus {
            outline: none;
            border-color: var(--accent);
            box-shadow: 0 0 0 3px var(--accent-glow);
        }

        input::placeholder,
        textarea::placeholder {
            color: var(--text-muted);
        }

        select {
            cursor: pointer;
            appearance: none;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='%2394a3b8'%3E%3Cpath d='M7 10l5 5 5-5z'/%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 14px center;
            padding-right: 40px;
        }

        textarea {
            resize: vertical;
            min-height: 80px;
            line-height: 1.6;
        }

        .textarea-highlight {
            background: linear-gradient(135deg, var(--accent-glow), transparent);
            border-color: var(--accent);
        }

        .input-row {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .input-row input[type="number"] {
            width: 90px;
            text-align: center;
        }

        .input-suffix {
            font-size: 0.9rem;
            color: var(--text-muted);
            font-weight: 500;
        }

        /* Section Title */
        .section-title {
            font-size: 0.75rem;
            font-weight: 600;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 1px;
            margin: 24px 0 16px;
            padding-top: 20px;
            border-top: 1px solid var(--border);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .section-title::before {
            content: '';
            width: 4px;
            height: 16px;
            background: var(--gradient-1);
            border-radius: 2px;
        }

        /* Translator */
        .translator {
            display: grid;
            grid-template-columns: 1fr 70px 1fr;
            background: var(--bg-card);
            border-radius: var(--radius-xl);
            border: 1px solid var(--border);
            box-shadow: var(--shadow-lg);
            overflow: hidden;
            min-height: 500px;
        }

        @media (max-width: 900px) {
            .translator {
                grid-template-columns: 1fr;
            }
        }

        .panel {
            display: flex;
            flex-direction: column;
        }

        .panel-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 16px 20px;
            background: var(--bg-tertiary);
            border-bottom: 1px solid var(--border);
        }

        .panel-title {
            font-size: 0.9rem;
            font-weight: 600;
            color: var(--text-primary);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .panel-title::before {
            content: '';
            width: 8px;
            height: 8px;
            background: var(--accent);
            border-radius: 50%;
        }

        .panel-actions {
            display: flex;
            gap: 6px;
        }

        .btn-icon {
            background: var(--bg-input);
            border: 1px solid var(--border);
            padding: 8px;
            border-radius: var(--radius-sm);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--text-muted);
            transition: all 0.2s;
        }

        .btn-icon:hover {
            background: var(--accent);
            border-color: var(--accent);
            color: white;
            transform: translateY(-1px);
        }

        .btn-icon svg {
            width: 16px;
            height: 16px;
            fill: currentColor;
        }

        .panel-body {
            flex: 1;
            padding: 20px;
            background: var(--bg-secondary);
        }

        .main-textarea {
            width: 100%;
            height: 100%;
            min-height: 420px;
            background: transparent;
            border: none;
            color: var(--text-primary);
            font-size: 1rem;
            line-height: 1.8;
            resize: none;
        }

        .main-textarea:focus {
            outline: none;
        }

        /* Center Action */
        .center-action {
            display: flex;
            align-items: center;
            justify-content: center;
            background: linear-gradient(180deg, var(--bg-tertiary) 0%, var(--bg-secondary) 100%);
            border-left: 1px solid var(--border);
            border-right: 1px solid var(--border);
        }

        @media (max-width: 900px) {
            .center-action {
                padding: 20px;
                border-left: none;
                border-right: none;
                border-top: 1px solid var(--border);
                border-bottom: 1px solid var(--border);
            }
        }

        .btn-convert {
            width: 52px;
            height: 52px;
            background: var(--gradient-1);
            border: none;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s;
            box-shadow: 0 4px 20px rgba(139, 92, 246, 0.4);
        }

        .btn-convert:hover {
            transform: scale(1.1) rotate(5deg);
            box-shadow: 0 6px 30px rgba(139, 92, 246, 0.5);
        }

        .btn-convert:active {
            transform: scale(0.95);
        }

        .btn-convert svg {
            width: 22px;
            height: 22px;
            fill: white;
        }

        /* Output */
        .output-area {
            color: var(--text-primary);
            font-size: 0.95rem;
            line-height: 1.7;
        }

        .output-placeholder {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100%;
            min-height: 420px;
            color: var(--text-muted);
            text-align: center;
            gap: 16px;
        }

        .output-placeholder svg {
            width: 56px;
            height: 56px;
            fill: var(--text-muted);
            opacity: 0.3;
        }

        .output-placeholder p {
            font-size: 1rem;
        }

        /* Script Output */
        .script-header {
            margin-bottom: 20px;
            padding-bottom: 16px;
            border-bottom: 2px solid var(--border);
        }

        .script-title {
            font-size: 1.15rem;
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 6px;
        }

        .script-meta {
            font-size: 0.85rem;
            color: var(--text-muted);
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }

        .script-meta span {
            background: var(--bg-tertiary);
            padding: 4px 10px;
            border-radius: var(--radius-sm);
        }

        .important-box {
            background: linear-gradient(135deg, var(--accent-glow), transparent);
            border: 1px solid var(--accent);
            border-radius: var(--radius-md);
            padding: 16px;
            margin-bottom: 20px;
        }

        .important-box-title {
            font-size: 0.8rem;
            font-weight: 700;
            color: var(--accent-light);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .important-box-content {
            font-size: 0.9rem;
            color: var(--text-primary);
            line-height: 1.6;
        }

        /* Video Block */
        .video-block {
            background: var(--bg-tertiary);
            border-radius: var(--radius-md);
            margin-bottom: 16px;
            overflow: hidden;
            border: 1px solid var(--border);
        }

        .video-header {
            background: var(--gradient-1);
            padding: 12px 18px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .video-title {
            font-weight: 600;
            color: white;
            font-size: 0.9rem;
        }

        .video-badge {
            background: rgba(255,255,255,0.2);
            padding: 4px 12px;
            border-radius: var(--radius-lg);
            font-size: 0.8rem;
            color: white;
            font-weight: 500;
        }

        .video-body {
            padding: 18px;
        }

        /* Scene */
        .scene {
            margin-bottom: 18px;
            padding-bottom: 18px;
            border-bottom: 1px solid var(--border);
        }

        .scene:last-child {
            margin-bottom: 0;
            padding-bottom: 0;
            border-bottom: none;
        }

        .scene-row {
            margin-bottom: 10px;
        }

        .scene-row:last-child {
            margin-bottom: 0;
        }

        .scene-label {
            font-size: 0.7rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 4px;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .scene-label::before {
            content: '';
            width: 6px;
            height: 6px;
            border-radius: 50%;
        }

        .scene-label.hook { color: var(--warning); }
        .scene-label.hook::before { background: var(--warning); }
        .scene-label.visual { color: #c084fc; }
        .scene-label.visual::before { background: #c084fc; }
        .scene-label.narration { color: var(--accent-light); }
        .scene-label.narration::before { background: var(--accent-light); }
        .scene-label.cta { color: var(--success); }
        .scene-label.cta::before { background: var(--success); }

        .scene-text {
            font-size: 0.9rem;
            padding: 10px 14px;
            border-radius: var(--radius-sm);
            background: var(--bg-secondary);
            border-left: 3px solid var(--border);
        }

        .scene-text.hook {
            border-color: var(--warning);
            color: var(--text-primary);
            font-weight: 500;
        }

        .scene-text.visual {
            border-color: #c084fc;
            color: var(--text-secondary);
            font-style: italic;
        }

        .scene-text.narration {
            border-color: var(--accent-light);
            color: var(--text-primary);
        }

        .scene-text.cta {
            border-color: var(--success);
            color: var(--text-primary);
            font-weight: 500;
        }

        .scene-time {
            font-size: 0.8rem;
            color: var(--text-muted);
            margin-top: 10px;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        /* Refine Panel */
        .refine-panel {
            display: none;
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: var(--radius-xl);
            margin-top: 24px;
            overflow: hidden;
            box-shadow: var(--shadow-md);
        }

        .refine-panel.active {
            display: block;
            animation: slideIn 0.3s ease;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .refine-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 18px 24px;
            background: var(--bg-tertiary);
            border-bottom: 1px solid var(--border);
        }

        .refine-title {
            font-size: 1rem;
            font-weight: 600;
            color: var(--text-primary);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .refine-title svg {
            width: 20px;
            height: 20px;
            fill: var(--accent-light);
        }

        .refine-counter {
            font-size: 0.85rem;
            color: var(--text-secondary);
            background: var(--bg-input);
            padding: 6px 14px;
            border-radius: var(--radius-lg);
            border: 1px solid var(--border);
        }

        .refine-counter span {
            color: var(--accent-light);
            font-weight: 700;
        }

        .refine-body {
            padding: 24px;
        }

        .refine-body > p {
            font-size: 0.9rem;
            color: var(--text-secondary);
            margin-bottom: 18px;
        }

        .refine-options {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 20px;
        }

        .refine-chip {
            padding: 10px 18px;
            background: var(--bg-input);
            border: 2px solid var(--border);
            border-radius: var(--radius-lg);
            font-size: 0.9rem;
            font-weight: 500;
            color: var(--text-secondary);
            cursor: pointer;
            transition: all 0.2s;
        }

        .refine-chip:hover {
            border-color: var(--accent);
            color: var(--text-primary);
            transform: translateY(-2px);
        }

        .refine-chip.selected {
            background: var(--accent);
            border-color: var(--accent);
            color: white;
            box-shadow: 0 4px 15px rgba(139, 92, 246, 0.3);
        }

        .refine-custom {
            margin-top: 20px;
        }

        .refine-custom label {
            display: block;
            font-size: 0.85rem;
            font-weight: 600;
            color: var(--text-secondary);
            margin-bottom: 10px;
        }

        .refine-custom textarea {
            width: 100%;
            min-height: 100px;
        }

        .refine-actions {
            display: flex;
            gap: 14px;
            margin-top: 20px;
        }

        .btn-refine {
            flex: 1;
            padding: 14px 24px;
            background: var(--gradient-1);
            border: none;
            border-radius: var(--radius-md);
            color: white;
            font-size: 0.95rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            box-shadow: 0 4px 15px rgba(139, 92, 246, 0.3);
        }

        .btn-refine:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(139, 92, 246, 0.4);
        }

        .btn-refine:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        .btn-refine svg {
            width: 18px;
            height: 18px;
            fill: currentColor;
        }

        .btn-refine.btn-secondary {
            background: var(--bg-tertiary);
            color: var(--text-secondary);
            box-shadow: none;
            border: 1px solid var(--border);
        }

        .btn-refine.btn-secondary:hover {
            background: var(--bg-input);
            color: var(--text-primary);
            box-shadow: none;
        }

        /* Refine History */
        .refine-history {
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px solid var(--border);
        }

        .refine-history-title {
            font-size: 0.8rem;
            font-weight: 600;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 12px;
        }

        .refine-history-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px 16px;
            background: var(--bg-input);
            border-radius: var(--radius-sm);
            margin-bottom: 10px;
            border: 1px solid var(--border);
        }

        .refine-history-item:last-child {
            margin-bottom: 0;
        }

        .refine-history-number {
            width: 24px;
            height: 24px;
            background: var(--gradient-1);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.75rem;
            font-weight: 700;
            color: white;
        }

        .refine-history-text {
            color: var(--text-secondary);
            font-size: 0.9rem;
            flex: 1;
        }

        /* Footer */
        .footer {
            text-align: center;
            padding: 32px;
            color: var(--text-muted);
            font-size: 0.85rem;
        }

        .footer a {
            color: var(--accent-light);
            text-decoration: none;
        }

        /* Animations */
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .loading {
            animation: pulse 1.5s ease-in-out infinite;
        }

        /* Header Actions */
        .header-actions {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        /* Modal */
        .modal-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(4px);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }

        .modal-overlay.active {
            display: flex;
        }

        .modal {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: var(--radius-xl);
            width: 100%;
            max-width: 480px;
            box-shadow: var(--shadow-lg);
            animation: slideIn 0.3s ease;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px 24px;
            border-bottom: 1px solid var(--border);
        }

        .modal-header h3 {
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--text-primary);
        }

        .modal-body {
            padding: 24px;
        }

        .modal-info {
            font-size: 0.9rem;
            color: var(--text-secondary);
            margin-bottom: 20px;
            line-height: 1.6;
        }

        .modal-info a {
            color: var(--accent-light);
            text-decoration: none;
        }

        .modal-info a:hover {
            text-decoration: underline;
        }

        .modal-body .config-group {
            margin-bottom: 16px;
        }

        .modal-footer {
            display: flex;
            gap: 12px;
            padding: 20px 24px;
            border-top: 1px solid var(--border);
        }

        .modal-footer .btn-refine {
            flex: 1;
        }

        .api-status {
            padding: 12px 16px;
            border-radius: var(--radius-md);
            font-size: 0.85rem;
            margin-top: 16px;
            display: none;
        }

        .api-status.success {
            display: block;
            background: rgba(52, 211, 153, 0.15);
            border: 1px solid var(--success);
            color: var(--success);
        }

        .api-status.error {
            display: block;
            background: rgba(248, 113, 113, 0.15);
            border: 1px solid var(--error);
            color: var(--error);
        }

        /* Loading State */
        .generating {
            position: relative;
            pointer-events: none;
        }

        .generating::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 24px;
            height: 24px;
            margin: -12px 0 0 -12px;
            border: 3px solid var(--accent-glow);
            border-top-color: var(--accent);
            border-radius: 50%;
            animation: spin 0.8s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .btn-convert.generating svg {
            opacity: 0;
        }

        /* AI Badge */
        .ai-badge {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            background: var(--gradient-2);
            padding: 4px 10px;
            border-radius: var(--radius-sm);
            font-size: 0.75rem;
            font-weight: 600;
            color: white;
            margin-left: 8px;
        }

        .ai-badge svg {
            width: 12px;
            height: 12px;
            fill: white;
        }

        /* Usage Counter */
        .usage-counter {
            display: flex;
            align-items: center;
            gap: 8px;
            background: var(--bg-tertiary);
            padding: 8px 16px;
            border-radius: var(--radius-lg);
            border: 1px solid var(--border);
        }

        .usage-text {
            font-size: 0.85rem;
            color: var(--text-secondary);
        }

        .usage-text span {
            font-weight: 700;
            color: var(--accent-light);
        }

        .usage-counter.warning .usage-text span {
            color: var(--warning);
        }

        .usage-counter.danger .usage-text span {
            color: var(--error);
        }

        .usage-counter.premium {
            background: var(--gradient-2);
            border: none;
        }

        .usage-counter.premium .usage-text {
            color: white;
        }

        /* Badge Status */
        .badge-status {
            display: inline-block;
            padding: 4px 12px;
            border-radius: var(--radius-lg);
            font-size: 0.8rem;
            font-weight: 600;
        }

        .badge-status.free {
            background: var(--bg-tertiary);
            color: var(--text-secondary);
        }

        .badge-status.premium {
            background: var(--gradient-2);
            color: white;
        }

        /* Plans Grid */
        .plans-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
        }

        @media (max-width: 600px) {
            .plans-grid {
                grid-template-columns: 1fr;
            }
        }

        .plan-card {
            background: var(--bg-tertiary);
            border: 2px solid var(--border);
            border-radius: var(--radius-lg);
            padding: 24px;
            position: relative;
        }

        .plan-card.featured {
            border-color: var(--accent);
            background: linear-gradient(135deg, var(--accent-glow), transparent);
        }

        .plan-badge {
            position: absolute;
            top: -12px;
            left: 50%;
            transform: translateX(-50%);
            background: var(--gradient-2);
            color: white;
            padding: 4px 16px;
            border-radius: var(--radius-lg);
            font-size: 0.75rem;
            font-weight: 600;
        }

        .plan-name {
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 8px;
        }

        .plan-price {
            font-size: 2rem;
            font-weight: 700;
            background: var(--gradient-1);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 16px;
        }

        .plan-price span {
            font-size: 1rem;
            font-weight: 400;
        }

        .plan-features {
            list-style: none;
            margin-bottom: 20px;
        }

        .plan-features li {
            padding: 8px 0;
            color: var(--text-secondary);
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .plan-features li::before {
            content: '‚úì';
            color: var(--success);
            font-weight: bold;
        }
    </style>
</head>
<body data-theme="dark">
    <div class="container">
        <!-- Header -->
        <header class="header">
            <div class="logo">
                <div class="logo-icon">
                    <svg viewBox="0 0 24 24"><path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-8 12H9.5v-2H7v-2h2.5V9H11v2h2v2h-2v2zm7-1h-4v-2h4v2zm0-4h-4V8h4v2z"/></svg>
                </div>
                <span class="logo-text">Roteirizador</span>
            </div>
            <div class="header-actions">
                <div class="usage-counter" id="usageCounter">
                    <span class="usage-text"><span id="usageRemaining">3</span> v√≠deos restantes</span>
                </div>
                <button class="btn-icon" onclick="abrirModalAuth()" title="Entrar / Cadastrar" id="btnAuth">
                    <svg viewBox="0 0 24 24"><path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/></svg>
                </button>
                <div class="theme-select">
                    <label for="themeSelect">Tema</label>
                    <select id="themeSelect" onchange="setTheme(this.value)">
                        <option value="dark">Escuro</option>
                        <option value="light">Claro</option>
                    </select>
                </div>
            </div>
        </header>

        <!-- Modal Autentica√ß√£o -->
        <div class="modal-overlay" id="modalAuth">
            <div class="modal">
                <div class="modal-header">
                    <h3 id="authModalTitle">Entrar</h3>
                    <button class="btn-icon" onclick="fecharModalAuth()">
                        <svg viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
                    </button>
                </div>
                <div class="modal-body">
                    <!-- Login Form -->
                    <div id="loginForm">
                        <div class="config-group">
                            <label class="config-label">Email</label>
                            <input type="email" id="loginEmail" placeholder="seu@email.com">
                        </div>
                        <div class="config-group">
                            <label class="config-label">Senha</label>
                            <input type="password" id="loginSenha" placeholder="Sua senha">
                        </div>
                        <div class="api-status" id="loginStatus"></div>
                        <button class="btn-refine" style="width: 100%; margin-top: 16px;" onclick="fazerLogin()">Entrar</button>
                        <p style="text-align: center; margin-top: 16px; color: var(--text-muted); font-size: 0.9rem;">
                            N√£o tem conta? <a href="#" onclick="mostrarCadastro()" style="color: var(--accent-light);">Cadastre-se</a>
                        </p>
                    </div>
                    <!-- Registro Form -->
                    <div id="registerForm" style="display: none;">
                        <div class="config-group">
                            <label class="config-label">Nome</label>
                            <input type="text" id="registerNome" placeholder="Seu nome">
                        </div>
                        <div class="config-group">
                            <label class="config-label">Email</label>
                            <input type="email" id="registerEmail" placeholder="seu@email.com">
                        </div>
                        <div class="config-group">
                            <label class="config-label">Senha</label>
                            <input type="password" id="registerSenha" placeholder="Crie uma senha">
                        </div>
                        <div class="api-status" id="registerStatus"></div>
                        <button class="btn-refine" style="width: 100%; margin-top: 16px;" onclick="fazerCadastro()">Cadastrar</button>
                        <p style="text-align: center; margin-top: 16px; color: var(--text-muted); font-size: 0.9rem;">
                            J√° tem conta? <a href="#" onclick="mostrarLogin()" style="color: var(--accent-light);">Entrar</a>
                        </p>
                    </div>
                    <!-- Usu√°rio Logado -->
                    <div id="userLoggedForm" style="display: none;">
                        <div style="text-align: center; padding: 20px 0;">
                            <div style="width: 60px; height: 60px; background: var(--gradient-1); border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 16px;">
                                <svg viewBox="0 0 24 24" style="width: 32px; height: 32px; fill: white;"><path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/></svg>
                            </div>
                            <h3 id="userNameDisplay" style="margin-bottom: 4px;">Usu√°rio</h3>
                            <p id="userEmailDisplay" style="color: var(--text-muted); font-size: 0.9rem; margin-bottom: 8px;">email@exemplo.com</p>
                            <span class="badge-status" id="userStatusBadge">Gr√°tis</span>
                        </div>
                        <div id="upgradeSection" style="background: var(--bg-tertiary); padding: 16px; border-radius: var(--radius-md); margin-bottom: 16px;">
                            <p style="font-size: 0.9rem; color: var(--text-secondary); margin-bottom: 12px;">Desbloqueie v√≠deos ilimitados!</p>
                            <button class="btn-refine" style="width: 100%; background: var(--gradient-2);" onclick="mostrarPlanos()">
                                Assinar Premium
                            </button>
                        </div>
                        <button class="btn-refine btn-secondary" style="width: 100%;" onclick="fazerLogout()">Sair da conta</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Modal Limite Atingido -->
        <div class="modal-overlay" id="modalLimite">
            <div class="modal">
                <div class="modal-header">
                    <h3>Limite de v√≠deos atingido</h3>
                    <button class="btn-icon" onclick="fecharModalLimite()">
                        <svg viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
                    </button>
                </div>
                <div class="modal-body" style="text-align: center; padding: 32px;">
                    <div style="font-size: 4rem; margin-bottom: 16px;">üé¨</div>
                    <h3 style="margin-bottom: 8px;">Voc√™ usou seus 3 v√≠deos gratuitos!</h3>
                    <p style="color: var(--text-secondary); margin-bottom: 24px;">Cadastre-se ou assine o plano Premium para gerar v√≠deos ilimitados.</p>
                    <button class="btn-refine" style="width: 100%; margin-bottom: 12px;" onclick="fecharModalLimite(); abrirModalAuth();">
                        Cadastrar / Entrar
                    </button>
                    <button class="btn-refine" style="width: 100%; background: var(--gradient-2);" onclick="mostrarPlanos()">
                        Ver planos Premium
                    </button>
                </div>
            </div>
        </div>

        <!-- Modal Planos -->
        <div class="modal-overlay" id="modalPlanos">
            <div class="modal" style="max-width: 600px;">
                <div class="modal-header">
                    <h3>Escolha seu plano</h3>
                    <button class="btn-icon" onclick="fecharModalPlanos()">
                        <svg viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
                    </button>
                </div>
                <div class="modal-body">
                    <div class="plans-grid">
                        <div class="plan-card">
                            <div class="plan-name">Gr√°tis</div>
                            <div class="plan-price">R$ 0</div>
                            <ul class="plan-features">
                                <li>3 v√≠deos por m√™s</li>
                                <li>Todos os formatos</li>
                                <li>Ganchos e CTAs</li>
                            </ul>
                            <button class="btn-refine btn-secondary" style="width: 100%;" disabled>Plano atual</button>
                        </div>
                        <div class="plan-card featured">
                            <div class="plan-badge">Mais popular</div>
                            <div class="plan-name">Premium</div>
                            <div class="plan-price">R$ 29<span>/m√™s</span></div>
                            <ul class="plan-features">
                                <li>V√≠deos ilimitados</li>
                                <li>Todos os formatos</li>
                                <li>Ganchos e CTAs</li>
                                <li>Refinamentos ilimitados</li>
                                <li>Suporte priorit√°rio</li>
                            </ul>
                            <button class="btn-refine" style="width: 100%; background: var(--gradient-2);" onclick="assinarPremium()">
                                Assinar agora
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Hero -->
        <section class="hero">
            <h1>Transforme Textos em Roteiros</h1>
            <p>Converta seu conte√∫do em roteiros profissionais prontos para gravar</p>
        </section>

        <!-- Config Section -->
        <div class="config-section">
            <!-- Abas de Configura√ß√£o -->
            <div class="config-tabs">
                <button class="config-tab active" onclick="switchConfigTab('basico')" id="tabBasico">
                    <svg viewBox="0 0 24 24"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/></svg>
                    B√°sico
                </button>
                <button class="config-tab" onclick="switchConfigTab('avancado')" id="tabAvancado">
                    <svg viewBox="0 0 24 24"><path d="M19.14 12.94c.04-.31.06-.63.06-.94 0-.31-.02-.63-.06-.94l2.03-1.58c.18-.14.23-.41.12-.61l-1.92-3.32c-.12-.22-.37-.29-.59-.22l-2.39.96c-.5-.38-1.03-.7-1.62-.94l-.36-2.54c-.04-.24-.24-.41-.48-.41h-3.84c-.24 0-.43.17-.47.41l-.36 2.54c-.59.24-1.13.57-1.62.94l-2.39-.96c-.22-.08-.47 0-.59.22L2.74 8.87c-.12.21-.08.47.12.61l2.03 1.58c-.04.31-.06.63-.06.94s.02.63.06.94l-2.03 1.58c-.18.14-.23.41-.12.61l1.92 3.32c.12.22.37.29.59.22l2.39-.96c.5.38 1.03.7 1.62.94l.36 2.54c.05.24.24.41.48.41h3.84c.24 0 .44-.17.47-.41l.36-2.54c.59-.24 1.13-.56 1.62-.94l2.39.96c.22.08.47 0 .59-.22l1.92-3.32c.12-.22.07-.47-.12-.61l-2.01-1.58zM12 15.6c-1.98 0-3.6-1.62-3.6-3.6s1.62-3.6 3.6-3.6 3.6 1.62 3.6 3.6-1.62 3.6-3.6 3.6z"/></svg>
                    Avan√ßado
                </button>
            </div>

            <!-- Aba B√°sico -->
            <div class="config-tab-content active" id="contentBasico">
                <div class="config-row">
                    <div class="config-group">
                        <label class="config-label">Tipo de conte√∫do</label>
                        <select id="tipoConteudo">
                            <option value="stories">Stories</option>
                            <option value="reels">Reels / TikTok</option>
                            <option value="youtube">YouTube</option>
                            <option value="venda">V√≠deo de Venda</option>
                            <option value="curso">Aula / Curso</option>
                            <option value="institucional">Institucional</option>
                            <option value="podcast">Podcast</option>
                        </select>
                    </div>
                    <div class="config-group">
                        <label class="config-label">Tom</label>
                        <select id="tomConteudo">
                            <option value="conversacional">Conversacional</option>
                            <option value="amigavel">Amig√°vel</option>
                            <option value="profissional">Profissional</option>
                            <option value="energetico">Energ√©tico</option>
                            <option value="inspirador">Inspirador</option>
                            <option value="educativo">Educativo</option>
                            <option value="urgente">Urgente</option>
                        </select>
                    </div>
                    <div class="config-group">
                        <label class="config-label">V√≠deos</label>
                        <div class="input-row">
                            <input type="number" id="numVideos" value="1" min="1" max="10">
                            <span class="input-suffix">v√≠deo(s)</span>
                        </div>
                    </div>
                    <div class="config-group">
                        <label class="config-label">Dura√ß√£o</label>
                        <div class="input-row">
                            <input type="number" id="duracaoVideo" value="60" min="15" max="600" step="15">
                            <span class="input-suffix">segundos</span>
                        </div>
                    </div>
                    <div class="config-group">
                        <label class="config-label">Formato de sa√≠da</label>
                        <select id="formatoSaida">
                            <option value="completo">Completo (Visual + Narra√ß√£o)</option>
                            <option value="script">S√≥ Script (apenas fala)</option>
                            <option value="cenario">Cen√°rio e Narrativa</option>
                        </select>
                    </div>
                </div>
            </div>

            <!-- Aba Avan√ßado -->
            <div class="config-tab-content" id="contentAvancado">
                <div class="config-row">
                    <div class="config-group">
                        <label class="config-label">Seu nome / Canal</label>
                        <input type="text" id="nomeCanal" placeholder="Ex: Maria Silva">
                    </div>
                    <div class="config-group">
                        <label class="config-label">Assunto do v√≠deo</label>
                        <input type="text" id="assuntoVideo" placeholder="Ex: Marketing Digital">
                    </div>
                    <div class="config-group">
                        <label class="config-label">Plataforma</label>
                        <select id="redeSocial">
                            <option value="ensinonacional" selected>Ensino Nacional</option>
                            <option value="instagram">Instagram</option>
                            <option value="tiktok">TikTok</option>
                            <option value="youtube">YouTube</option>
                            <option value="linkedin">LinkedIn</option>
                            <option value="facebook">Facebook</option>
                            <option value="twitter">X / Twitter</option>
                            <option value="outro">Outro</option>
                        </select>
                    </div>
                </div>

                <div class="section-title">Elementos do Roteiro</div>

                <div class="config-row">
                    <div class="config-group">
                        <label class="config-label">Tipo de gancho</label>
                        <select id="tipoGancho">
                            <option value="nenhum">Sem gancho</option>
                            <option value="duvida" selected>Gerar d√∫vida</option>
                            <option value="desafio">Desafiar o espectador</option>
                            <option value="storytelling">Storytelling / Hist√≥ria</option>
                            <option value="estatistica">Estat√≠stica impactante</option>
                            <option value="pergunta">Pergunta direta</option>
                            <option value="controverso">Afirma√ß√£o controversa</option>
                            <option value="problema">Apresentar problema</option>
                            <option value="curiosidade">Despertar curiosidade</option>
                            <option value="promessa">Promessa de resultado</option>
                            <option value="erro">Erro comum</option>
                            <option value="segredo">Revelar segredo</option>
                            <option value="urgencia">Criar urg√™ncia</option>
                        </select>
                    </div>
                    <div class="config-group">
                        <label class="config-label">Chamada para a√ß√£o (CTA)</label>
                        <select id="tipoCTA">
                            <option value="nenhum">Sem CTA</option>
                            <option value="comentar" selected>Comenta aqui</option>
                            <option value="curtir">Curte esse v√≠deo</option>
                            <option value="compartilhar">Compartilha com algu√©m</option>
                            <option value="seguir">Segue para mais</option>
                            <option value="inscrever">Se inscreve no canal</option>
                            <option value="salvar">Salva para depois</option>
                            <option value="link">Clica no link da bio</option>
                            <option value="proxima">Veja a pr√≥xima aula</option>
                            <option value="ativar">Ativa as notifica√ß√µes</option>
                            <option value="baixar">Baixa o material</option>
                            <option value="comprar">Garanta o seu agora</option>
                            <option value="contato">Chama no direct/WhatsApp</option>
                            <option value="marcar">Marca um amigo</option>
                        </select>
                    </div>
                </div>

                <div class="config-row">
                    <div class="config-group span-2">
                        <label class="config-label highlight">Pontos cruciais - O que n√£o pode faltar</label>
                        <textarea id="pontosCruciais" class="textarea-highlight" placeholder="Ex: Mencionar o desconto de 50%, mostrar o antes e depois, falar do prazo limitado..."></textarea>
                    </div>
                </div>
            </div>
        </div>

        <!-- Translator -->
        <div class="translator">
            <div class="panel">
                <div class="panel-header">
                    <span class="panel-title">Texto original</span>
                    <div class="panel-actions">
                        <button class="btn-icon" onclick="colarTexto()" title="Colar">
                            <svg viewBox="0 0 24 24"><path d="M19 2h-4.18C14.4.84 13.3 0 12 0c-1.3 0-2.4.84-2.82 2H5c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-7 0c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zm7 18H5V4h2v3h10V4h2v16z"/></svg>
                        </button>
                        <button class="btn-icon" onclick="limparTexto()" title="Limpar">
                            <svg viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
                        </button>
                    </div>
                </div>
                <div class="panel-body">
                    <textarea class="main-textarea" id="inputText" placeholder="Cole aqui o texto que voc√™ quer transformar em roteiro...

Pode ser uma ideia, um artigo, uma transcri√ß√£o ou qualquer conte√∫do que voc√™ queira adaptar para v√≠deo."></textarea>
                </div>
            </div>

            <div class="center-action">
                <button class="btn-convert" onclick="gerarRoteiro()" title="Gerar Roteiro">
                    <svg viewBox="0 0 24 24"><path d="M12 4l-1.41 1.41L16.17 11H4v2h12.17l-5.58 5.59L12 20l8-8z"/></svg>
                </button>
            </div>

            <div class="panel">
                <div class="panel-header">
                    <span class="panel-title">Roteiro gerado</span>
                    <div class="panel-actions">
                        <button class="btn-icon" onclick="copiarRoteiro()" title="Copiar">
                            <svg viewBox="0 0 24 24"><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"/></svg>
                        </button>
                    </div>
                </div>
                <div class="panel-body">
                    <div class="output-area" id="outputArea">
                        <div class="output-placeholder">
                            <svg viewBox="0 0 24 24"><path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-8 12H9.5v-2H7v-2h2.5V9H11v2h2v2h-2v2zm7-1h-4v-2h4v2zm0-4h-4V8h4v2z"/></svg>
                            <p>Seu roteiro aparecer√° aqui</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Refine Panel -->
        <div class="refine-panel" id="refinePanel">
            <div class="refine-header">
                <div class="refine-title">
                    <svg viewBox="0 0 24 24"><path d="M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.39-.39-1.02-.39-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"/></svg>
                    Aprimorar Roteiro
                </div>
                <div class="refine-counter">
                    Refinamentos: <span id="refineCount">0</span>/3
                </div>
            </div>
            <div class="refine-body">
                <p>Selecione o tipo de melhoria ou descreva o que deseja ajustar:</p>

                <div class="refine-options" id="refineOptions">
                    <div class="refine-chip" data-refine="mais-curto">Mais curto</div>
                    <div class="refine-chip" data-refine="mais-longo">Mais detalhado</div>
                    <div class="refine-chip" data-refine="mais-informal">Mais informal</div>
                    <div class="refine-chip" data-refine="mais-formal">Mais formal</div>
                    <div class="refine-chip" data-refine="mais-energia">Mais energia</div>
                    <div class="refine-chip" data-refine="mais-calmo">Mais calmo</div>
                    <div class="refine-chip" data-refine="mais-vendedor">Mais persuasivo</div>
                    <div class="refine-chip" data-refine="mais-educativo">Mais educativo</div>
                    <div class="refine-chip" data-refine="gancho-forte">Gancho mais forte</div>
                    <div class="refine-chip" data-refine="cta-forte">CTA mais forte</div>
                    <div class="refine-chip" data-refine="mais-emocional">Mais emocional</div>
                    <div class="refine-chip" data-refine="mais-direto">Mais direto</div>
                </div>

                <div class="refine-custom">
                    <label for="refineCustom">Ou descreva a melhoria que deseja:</label>
                    <textarea id="refineCustom" placeholder="Ex: Quero que o gancho seja mais impactante e mencione um n√∫mero espec√≠fico..."></textarea>
                </div>

                <div class="refine-actions">
                    <button class="btn-refine btn-secondary" onclick="fecharRefine()">
                        Cancelar
                    </button>
                    <button class="btn-refine" id="btnApplyRefine" onclick="aplicarRefinamento()">
                        <svg viewBox="0 0 24 24"><path d="M17.65 6.35C16.2 4.9 14.21 4 12 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08c-.82 2.33-3.04 4-5.65 4-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4l-2.35 2.35z"/></svg>
                        Aplicar Melhoria
                    </button>
                </div>

                <div class="refine-history" id="refineHistory" style="display: none;">
                    <div class="refine-history-title">Hist√≥rico de refinamentos</div>
                    <div id="refineHistoryList"></div>
                </div>
            </div>
        </div>

        <footer class="footer">
            Feito para criadores de conte√∫do
        </footer>
    </div>

    <script>
        // ==================== CONTROLE DE ABAS ====================

        function switchConfigTab(tabName) {
            // Remove active de todas as abas
            document.querySelectorAll('.config-tab').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('.config-tab-content').forEach(content => content.classList.remove('active'));

            // Ativa a aba selecionada
            if (tabName === 'basico') {
                document.getElementById('tabBasico').classList.add('active');
                document.getElementById('contentBasico').classList.add('active');
            } else {
                document.getElementById('tabAvancado').classList.add('active');
                document.getElementById('contentAvancado').classList.add('active');
            }
        }

        // ==================== CONTROLE DE USO E AUTENTICA√á√ÉO ====================

        const LIMITE_GRATIS = 3;

        // Controle de uso
        const UsageControl = {
            get count() {
                return parseInt(localStorage.getItem('videos_gerados') || '0');
            },
            increment() {
                const newCount = this.count + 1;
                localStorage.setItem('videos_gerados', newCount.toString());
                atualizarContadorUI();
                return newCount;
            },
            get remaining() {
                return Math.max(0, LIMITE_GRATIS - this.count);
            },
            get canGenerate() {
                // Sem limita√ß√£o por enquanto - todos podem gerar
                return true;
            }
        };

        // Autentica√ß√£o de usu√°rios
        const UserAuth = {
            get currentUser() {
                const userData = localStorage.getItem('current_user');
                return userData ? JSON.parse(userData) : null;
            },
            set currentUser(user) {
                if (user) {
                    localStorage.setItem('current_user', JSON.stringify(user));
                } else {
                    localStorage.removeItem('current_user');
                }
            },
            get users() {
                const users = localStorage.getItem('registered_users');
                return users ? JSON.parse(users) : [];
            },
            registerUser(email, password, name) {
                const users = this.users;
                if (users.find(u => u.email === email)) {
                    return { success: false, error: 'Email j√° cadastrado' };
                }
                const newUser = {
                    id: Date.now().toString(),
                    email, password, name,
                    isPremium: false,
                    createdAt: new Date().toISOString()
                };
                users.push(newUser);
                localStorage.setItem('registered_users', JSON.stringify(users));
                return { success: true, user: newUser };
            },
            loginUser(email, password) {
                const users = this.users;
                const user = users.find(u => u.email === email && u.password === password);
                if (user) {
                    this.currentUser = user;
                    return { success: true, user };
                }
                return { success: false, error: 'Email ou senha incorretos' };
            },
            logoutUser() {
                this.currentUser = null;
            },
            upgradeToPremium(userId) {
                const users = this.users;
                const userIndex = users.findIndex(u => u.id === userId);
                if (userIndex !== -1) {
                    users[userIndex].isPremium = true;
                    localStorage.setItem('registered_users', JSON.stringify(users));
                    if (this.currentUser && this.currentUser.id === userId) {
                        this.currentUser = users[userIndex];
                    }
                    return true;
                }
                return false;
            }
        };

        // ==================== UI DE AUTENTICA√á√ÉO ====================

        function abrirModalAuth() {
            document.getElementById('modalAuth').classList.add('active');
            atualizarModalAuth();
        }

        function fecharModalAuth() {
            document.getElementById('modalAuth').classList.remove('active');
        }

        function atualizarModalAuth() {
            const user = UserAuth.currentUser;
            if (user) {
                document.getElementById('loginForm').style.display = 'none';
                document.getElementById('registerForm').style.display = 'none';
                document.getElementById('userLoggedForm').style.display = 'block';
                document.getElementById('userNameDisplay').textContent = user.name;
                document.getElementById('userEmailDisplay').textContent = user.email;
                document.getElementById('userStatusBadge').textContent = user.isPremium ? 'Premium' : 'Gr√°tis';
                document.getElementById('userStatusBadge').className = 'badge-status ' + (user.isPremium ? 'premium' : 'free');
                document.getElementById('upgradeSection').style.display = user.isPremium ? 'none' : 'block';
                document.getElementById('authModalTitle').textContent = 'Minha conta';
            } else {
                document.getElementById('loginForm').style.display = 'block';
                document.getElementById('registerForm').style.display = 'none';
                document.getElementById('userLoggedForm').style.display = 'none';
                document.getElementById('authModalTitle').textContent = 'Entrar';
            }
        }

        function mostrarCadastro() {
            document.getElementById('loginForm').style.display = 'none';
            document.getElementById('registerForm').style.display = 'block';
            document.getElementById('authModalTitle').textContent = 'Criar conta';
        }

        function mostrarLogin() {
            document.getElementById('loginForm').style.display = 'block';
            document.getElementById('registerForm').style.display = 'none';
            document.getElementById('authModalTitle').textContent = 'Entrar';
        }

        function fazerLogin() {
            const email = document.getElementById('loginEmail').value.trim();
            const senha = document.getElementById('loginSenha').value;
            const status = document.getElementById('loginStatus');

            if (!email || !senha) {
                status.textContent = 'Preencha todos os campos';
                status.className = 'api-status error';
                return;
            }

            const result = UserAuth.loginUser(email, senha);
            if (result.success) {
                status.textContent = 'Login realizado com sucesso!';
                status.className = 'api-status success';
                setTimeout(() => {
                    atualizarModalAuth();
                    atualizarContadorUI();
                    document.getElementById('loginEmail').value = '';
                    document.getElementById('loginSenha').value = '';
                    status.className = 'api-status';
                }, 1000);
            } else {
                status.textContent = result.error;
                status.className = 'api-status error';
            }
        }

        function fazerCadastro() {
            const nome = document.getElementById('registerNome').value.trim();
            const email = document.getElementById('registerEmail').value.trim();
            const senha = document.getElementById('registerSenha').value;
            const status = document.getElementById('registerStatus');

            if (!nome || !email || !senha) {
                status.textContent = 'Preencha todos os campos';
                status.className = 'api-status error';
                return;
            }

            const result = UserAuth.registerUser(email, senha, nome);
            if (result.success) {
                UserAuth.currentUser = result.user;
                status.textContent = 'Conta criada com sucesso!';
                status.className = 'api-status success';
                setTimeout(() => {
                    atualizarModalAuth();
                    atualizarContadorUI();
                    document.getElementById('registerNome').value = '';
                    document.getElementById('registerEmail').value = '';
                    document.getElementById('registerSenha').value = '';
                    status.className = 'api-status';
                }, 1000);
            } else {
                status.textContent = result.error;
                status.className = 'api-status error';
            }
        }

        function fazerLogout() {
            UserAuth.logoutUser();
            atualizarModalAuth();
            atualizarContadorUI();
            fecharModalAuth();
        }

        // ==================== MODAIS AUXILIARES ====================

        function fecharModalLimite() {
            document.getElementById('modalLimite').classList.remove('active');
        }

        function mostrarPlanos() {
            document.getElementById('modalLimite').classList.remove('active');
            document.getElementById('modalAuth').classList.remove('active');
            document.getElementById('modalPlanos').classList.add('active');
        }

        function fecharModalPlanos() {
            document.getElementById('modalPlanos').classList.remove('active');
        }

        function assinarPremium() {
            const user = UserAuth.currentUser;
            if (!user) {
                alert('Fa√ßa login primeiro para assinar o Premium.');
                fecharModalPlanos();
                abrirModalAuth();
                return;
            }
            // Simular pagamento (em produ√ß√£o, integrar com gateway de pagamento)
            if (confirm('Simular assinatura Premium? (Em produ√ß√£o, isso seria um pagamento real)')) {
                UserAuth.upgradeToPremium(user.id);
                alert('Parab√©ns! Voc√™ agora √© Premium!');
                fecharModalPlanos();
                atualizarContadorUI();
            }
        }

        // ==================== ATUALIZA√á√ÉO DE UI ====================

        function atualizarContadorUI() {
            const user = UserAuth.currentUser;
            const counter = document.getElementById('usageCounter');
            const remaining = document.getElementById('usageRemaining');
            const btnAuth = document.getElementById('btnAuth');

            if (user && user.isPremium) {
                counter.className = 'usage-counter premium';
                counter.innerHTML = '<span class="usage-text">Premium - Ilimitado</span>';
            } else {
                const restantes = UsageControl.remaining;
                remaining.textContent = restantes;
                counter.className = 'usage-counter';
                if (restantes <= 1) {
                    counter.classList.add('danger');
                } else if (restantes <= 2) {
                    counter.classList.add('warning');
                }
            }

            // Atualizar √≠cone do bot√£o de auth
            if (user) {
                btnAuth.innerHTML = '<svg viewBox="0 0 24 24"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 3c1.66 0 3 1.34 3 3s-1.34 3-3 3-3-1.34-3-3 1.34-3 3-3zm0 14.2c-2.5 0-4.71-1.28-6-3.22.03-1.99 4-3.08 6-3.08 1.99 0 5.97 1.09 6 3.08-1.29 1.94-3.5 3.22-6 3.22z"/></svg>';
                btnAuth.title = user.name;
            }
        }

        // Inicializar contador ao carregar a p√°gina
        document.addEventListener('DOMContentLoaded', atualizarContadorUI);

        // ==================== CONFIGURA√á√ÉO API ====================

        let apiConfig = {
            key: localStorage.getItem('deepseek_api_key') || '',
            modelo: localStorage.getItem('deepseek_modelo') || 'deepseek-chat'
        };

        // ==================== CHAMADA API DEEPSEEK ====================

        async function chamarDeepSeek(prompt) {
            if (!apiConfig.key) {
                throw new Error('Configure sua chave API primeiro. Clique no √≠cone de engrenagem.');
            }

            const response = await fetch('https://api.deepseek.com/chat/completions', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'Authorization': `Bearer ${apiConfig.key}`
                },
                body: JSON.stringify({
                    model: apiConfig.modelo,
                    messages: [
                        {
                            role: 'system',
                            content: `Voc√™ √© um roteirista profissional especializado em criar roteiros para v√≠deos de redes sociais e conte√∫do digital.
Voc√™ cria roteiros envolventes, com ganchos poderosos e CTAs eficazes.
Sempre responda em portugu√™s brasileiro.
Retorne APENAS o JSON solicitado, sem explica√ß√µes adicionais ou markdown.`
                        },
                        {
                            role: 'user',
                            content: prompt
                        }
                    ],
                    temperature: 0.7,
                    max_tokens: 4000
                })
            });

            if (!response.ok) {
                const error = await response.json();
                throw new Error(error.error?.message || 'Erro na API DeepSeek');
            }

            const data = await response.json();
            return data.choices[0].message.content;
        }

        // Theme
        function setTheme(theme) {
            document.body.setAttribute('data-theme', theme);
            document.getElementById('themeSelect').value = theme;
            localStorage.setItem('theme', theme);
        }

        const savedTheme = localStorage.getItem('theme') || 'dark';
        setTheme(savedTheme);

        // Configs
        const tiposConfig = {
            stories: { gancho: true, cta: true },
            reels: { gancho: true, cta: true },
            youtube: { gancho: true, cta: true },
            venda: { gancho: true, cta: true },
            curso: { gancho: false, cta: false },
            institucional: { gancho: false, cta: true },
            podcast: { gancho: true, cta: true }
        };

        const tomsConfig = {
            conversacional: { abertura: "E a√≠, ", transicao: "Olha s√≥, ", fechamento: "√â isso!" },
            amigavel: { abertura: "Oi! ", transicao: "E sabe o que mais? ", fechamento: "Espero ter ajudado!" },
            profissional: { abertura: "", transicao: "Al√©m disso, ", fechamento: "Obrigado pela aten√ß√£o." },
            energetico: { abertura: "VAMOS L√Å! ", transicao: "E n√£o para por a√≠! ", fechamento: "Bora!" },
            inspirador: { abertura: "Imagine ", transicao: "A verdade √© que ", fechamento: "Comece agora." },
            educativo: { abertura: "Hoje voc√™ vai aprender ", transicao: "√â importante saber que ", fechamento: "Agora voc√™ sabe!" },
            urgente: { abertura: "ATEN√á√ÉO! ", transicao: "E mais: ", fechamento: "N√£o perca tempo!" }
        };

        const redesConfig = {
            ensinonacional: { cta: 'Acesse a plataforma e continue aprendendo!' },
            instagram: { cta: 'Salva esse post!' },
            tiktok: { cta: 'Segue pra mais!' },
            youtube: { cta: 'Se inscreve no canal!' },
            linkedin: { cta: 'Compartilhe com sua rede!' },
            facebook: { cta: 'Compartilhe!' },
            twitter: { cta: 'RT se concorda!' },
            outro: { cta: '' }
        };

        const ganchosConfig = {
            nenhum: { texto: '', visual: '' },
            duvida: { texto: 'Voc√™ sabia que a maioria das pessoas erra nisso?', visual: 'Express√£o de d√∫vida, interroga√ß√£o na tela' },
            desafio: { texto: 'Aposto que voc√™ n√£o consegue fazer isso...', visual: 'Express√£o desafiadora, gesto de "vem comigo"' },
            storytelling: { texto: 'Deixa eu te contar uma hist√≥ria...', visual: 'Close no rosto, ambiente intimista' },
            estatistica: { texto: '90% das pessoas n√£o sabem disso...', visual: 'N√∫mero grande na tela, gr√°fico impactante' },
            pergunta: { texto: 'Voc√™ j√° se perguntou por que isso acontece?', visual: 'Express√£o curiosa, interroga√ß√£o animada' },
            controverso: { texto: 'Isso que vou falar vai contra tudo que voc√™ acredita...', visual: 'Express√£o s√©ria, corte dram√°tico' },
            problema: { texto: 'Se voc√™ tem esse problema, presta aten√ß√£o...', visual: 'Express√£o de preocupa√ß√£o, X vermelho' },
            curiosidade: { texto: 'O que eu vou mostrar agora vai te surpreender...', visual: 'Olhar misterioso, suspense' },
            promessa: { texto: 'Em 60 segundos voc√™ vai aprender algo que vai mudar seu jogo...', visual: 'Contagem regressiva, energia alta' },
            erro: { texto: 'Esse √© o erro n√∫mero 1 que as pessoas cometem...', visual: 'Alerta, s√≠mbolo de erro na tela' },
            segredo: { texto: 'Vou revelar um segredo que poucos conhecem...', visual: 'Gesto de sil√™ncio, ambiente exclusivo' },
            urgencia: { texto: 'Para tudo que voc√™ est√° fazendo agora...', visual: 'Gesto de pare, express√£o urgente' }
        };

        const ctasConfig = {
            nenhum: { texto: '', visual: '' },
            comentar: { texto: 'Comenta aqui o que voc√™ achou!', visual: '√çcone de coment√°rio, seta apontando' },
            curtir: { texto: 'Deixa o like se esse conte√∫do te ajudou!', visual: 'Cora√ß√£o animado, bot√£o de curtir' },
            compartilhar: { texto: 'Manda pra algu√©m que precisa ver isso!', visual: '√çcone de compartilhar, seta' },
            seguir: { texto: 'Segue aqui pra n√£o perder nenhum conte√∫do!', visual: 'Bot√£o seguir destacado, seta' },
            inscrever: { texto: 'Se inscreve no canal e ativa o sininho!', visual: 'Bot√£o inscrever-se, sino animado' },
            salvar: { texto: 'Salva esse v√≠deo pra ver depois!', visual: '√çcone de salvar/bookmark' },
            link: { texto: 'Link na bio pra voc√™ saber mais!', visual: 'Seta apontando pra cima, destaque bio' },
            proxima: { texto: 'Na pr√≥xima aula eu vou te mostrar o passo seguinte...', visual: 'Preview do pr√≥ximo v√≠deo, seta' },
            ativar: { texto: 'Ativa as notifica√ß√µes pra n√£o perder nada!', visual: 'Sino animado, toggle de notifica√ß√£o' },
            baixar: { texto: 'Baixa o material gratuito no link!', visual: '√çcone de download, mockup do material' },
            comprar: { texto: 'Garanta o seu agora antes que acabe!', visual: 'Bot√£o de compra, urg√™ncia, estoque' },
            contato: { texto: 'Me chama no direct que eu te ajudo!', visual: '√çcone de mensagem, DM aberto' },
            marcar: { texto: 'Marca aquele amigo que precisa ver isso!', visual: '√çcone de arroba, tag de men√ß√£o' }
        };

        async function gerarRoteiro() {
            const texto = document.getElementById('inputText').value.trim();
            const outputArea = document.getElementById('outputArea');
            const btnConvert = document.querySelector('.btn-convert');

            if (!texto) {
                outputArea.innerHTML = `
                    <div class="output-placeholder">
                        <svg viewBox="0 0 24 24"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z"/></svg>
                        <p>Insira um texto para gerar o roteiro</p>
                    </div>
                `;
                return;
            }

            const nomeCanal = document.getElementById('nomeCanal').value.trim();
            const assunto = document.getElementById('assuntoVideo').value.trim();
            const tipo = document.getElementById('tipoConteudo').value;
            const tom = document.getElementById('tomConteudo').value;
            const rede = document.getElementById('redeSocial').value;
            const numVideos = parseInt(document.getElementById('numVideos').value) || 1;
            const duracaoVideo = parseInt(document.getElementById('duracaoVideo').value) || 60;
            const tipoGancho = document.getElementById('tipoGancho').value;
            const tipoCTA = document.getElementById('tipoCTA').value;
            const pontosCruciais = document.getElementById('pontosCruciais').value.trim();
            const formatoSaida = document.getElementById('formatoSaida').value;

            // Verificar limite de uso
            if (!UsageControl.canGenerate) {
                document.getElementById('modalLimite').classList.add('active');
                return;
            }

            // Verificar se tem API configurada
            if (!apiConfig.key) {
                outputArea.innerHTML = `
                    <div class="output-placeholder">
                        <svg viewBox="0 0 24 24"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z"/></svg>
                        <p style="color: var(--error);">API n√£o configurada</p>
                        <p style="font-size: 0.85rem; color: var(--text-muted);">Entre em contato com o administrador</p>
                    </div>
                `;
                return;
            }

            // Mostrar loading
            btnConvert.classList.add('generating');
            outputArea.innerHTML = `
                <div class="output-placeholder">
                    <div class="loading" style="font-size: 3rem;">ü§ñ</div>
                    <p>Gerando roteiro com IA...</p>
                    <p style="font-size: 0.85rem; color: var(--text-muted);">Isso pode levar alguns segundos</p>
                </div>
            `;

            // Montar prompt para IA
            const tipoGanchoTexto = tipoGancho !== 'nenhum' ? ganchosConfig[tipoGancho].texto : '';
            const tipoCTATexto = tipoCTA !== 'nenhum' ? ctasConfig[tipoCTA].texto : '';

            const prompt = `Crie um roteiro profissional para v√≠deo com as seguintes especifica√ß√µes:

TEXTO BASE:
${texto}

CONFIGURA√á√ïES:
- Nome/Canal: ${nomeCanal || 'N√£o especificado'}
- Assunto: ${assunto || 'N√£o especificado'}
- Tipo de conte√∫do: ${tipo}
- Tom: ${tom}
- Plataforma: ${rede}
- Quantidade de v√≠deos: ${numVideos}
- Dura√ß√£o de cada v√≠deo: ${duracaoVideo} segundos
- Tipo de gancho: ${tipoGancho !== 'nenhum' ? tipoGancho + ' (exemplo: "' + tipoGanchoTexto + '")' : 'Sem gancho'}
- CTA: ${tipoCTA !== 'nenhum' ? tipoCTA + ' (exemplo: "' + tipoCTATexto + '")' : 'Sem CTA'}
- Pontos cruciais: ${pontosCruciais || 'Nenhum especificado'}
- Formato de sa√≠da: ${formatoSaida === 'script' ? 'Apenas falas (script)' : formatoSaida === 'cenario' ? 'Cen√°rio e narrativa' : 'Completo (visual + narra√ß√£o)'}

INSTRU√á√ïES:
1. Crie ${numVideos} v√≠deo(s) de ${duracaoVideo} segundos cada
2. ${tipoGancho !== 'nenhum' ? 'Inclua um gancho impactante no in√≠cio do tipo: ' + tipoGancho : 'N√£o inclua gancho'}
3. ${tipoCTA !== 'nenhum' ? 'Inclua uma chamada para a√ß√£o do tipo: ' + tipoCTA : 'N√£o inclua CTA'}
4. Use o tom ${tom} em todo o roteiro
5. ${pontosCruciais ? 'OBRIGAT√ìRIO incluir estes pontos: ' + pontosCruciais : ''}
6. Adapte a linguagem para a plataforma ${rede}
7. Calcule a dura√ß√£o estimada de cada cena baseado em ~150 palavras por minuto

Retorne um JSON no seguinte formato (sem markdown, apenas JSON puro):
{
    "videos": [
        {
            "numero": 1,
            "cenas": [
                {
                    "tipo": "gancho|conteudo|cta",
                    "fala": "texto que a pessoa deve falar",
                    "visual": "descri√ß√£o do que mostrar na tela",
                    "duracao": 5
                }
            ]
        }
    ]
}`;

            try {
                const resposta = await chamarDeepSeek(prompt);

                // Tentar parsear o JSON
                let dados;
                try {
                    // Limpar poss√≠veis caracteres extras
                    const jsonLimpo = resposta.replace(/```json\n?/g, '').replace(/```\n?/g, '').trim();
                    dados = JSON.parse(jsonLimpo);
                } catch (e) {
                    console.error('Erro ao parsear JSON:', e, resposta);
                    throw new Error('A IA retornou um formato inv√°lido. Tente novamente.');
                }

                // Renderizar roteiro
                let roteiro = `
                    <div class="script-header">
                        <div class="script-title">${assunto || 'Roteiro de V√≠deo'}${nomeCanal ? ` ‚Ä¢ ${nomeCanal}` : ''}<span class="ai-badge"><svg viewBox="0 0 24 24"><path d="M21 11.5a8.38 8.38 0 0 1-.9 3.8 8.5 8.5 0 0 1-7.6 4.7 8.38 8.38 0 0 1-3.8-.9L3 21l1.9-5.7a8.38 8.38 0 0 1-.9-3.8 8.5 8.5 0 0 1 4.7-7.6 8.38 8.38 0 0 1 3.8-.9h.5a8.48 8.48 0 0 1 8 8v.5z"/></svg>IA</span></div>
                        <div class="script-meta">
                            <span>${numVideos} v√≠deo${numVideos > 1 ? 's' : ''}</span>
                            <span>${duracaoVideo}s cada</span>
                            <span>${capitalize(tipo)}</span>
                            <span>${capitalize(rede)}</span>
                        </div>
                    </div>
                `;

                if (pontosCruciais) {
                    roteiro += `
                        <div class="important-box">
                            <div class="important-box-title">‚≠ê N√£o esquecer</div>
                            <div class="important-box-content">${pontosCruciais}</div>
                        </div>
                    `;
                }

                dados.videos.forEach(video => {
                    roteiro += renderizarVideoIA(video, duracaoVideo, formatoSaida);
                });

                outputArea.innerHTML = roteiro;
                mostrarPainelRefine();

                // Incrementar contador de uso (apenas se n√£o for premium)
                const user = UserAuth.currentUser;
                if (!user || !user.isPremium) {
                    UsageControl.increment();
                }

            } catch (error) {
                console.error('Erro:', error);
                outputArea.innerHTML = `
                    <div class="output-placeholder">
                        <svg viewBox="0 0 24 24" style="fill: var(--error);"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z"/></svg>
                        <p style="color: var(--error);">Erro ao gerar roteiro</p>
                        <p style="font-size: 0.85rem; color: var(--text-muted);">${error.message}</p>
                        <button onclick="gerarRoteiro()" style="margin-top: 12px; padding: 10px 20px; background: var(--gradient-1); border: none; border-radius: var(--radius-md); color: white; cursor: pointer; font-weight: 600;">Tentar novamente</button>
                    </div>
                `;
            } finally {
                btnConvert.classList.remove('generating');
            }
        }

        function renderizarVideoIA(video, duracao, formato) {
            let html = '';

            video.cenas.forEach(cena => {
                if (formato === 'script') {
                    // S√≥ script - apenas falas
                    const labelClass = cena.tipo === 'gancho' ? 'hook' : cena.tipo === 'cta' ? 'cta' : 'narration';
                    const labelText = cena.tipo === 'gancho' ? 'Gancho' : cena.tipo === 'cta' ? 'CTA' : 'Fala';
                    html += `
                        <div class="scene">
                            <div class="scene-row">
                                <div class="scene-label ${labelClass}">${labelText}</div>
                                <div class="scene-text ${labelClass}">"${cena.fala}"</div>
                            </div>
                        </div>
                    `;
                } else if (formato === 'cenario') {
                    // Cen√°rio e narrativa
                    const labelClass = cena.tipo === 'gancho' ? 'hook' : cena.tipo === 'cta' ? 'cta' : 'narration';
                    html += `
                        <div class="scene">
                            <div class="scene-row">
                                <div class="scene-label visual">Cen√°rio</div>
                                <div class="scene-text visual">${cena.visual}</div>
                            </div>
                            <div class="scene-row">
                                <div class="scene-label ${labelClass}">Narrativa</div>
                                <div class="scene-text ${labelClass}">"${cena.fala}"</div>
                            </div>
                            <div class="scene-time">‚è± ${cena.duracao}s</div>
                        </div>
                    `;
                } else {
                    // Completo
                    const labelClass = cena.tipo === 'gancho' ? 'hook' : cena.tipo === 'cta' ? 'cta' : 'narration';
                    const labelText = cena.tipo === 'gancho' ? 'Gancho' : cena.tipo === 'cta' ? 'CTA' : 'Narra√ß√£o';
                    html += `
                        <div class="scene">
                            <div class="scene-row">
                                <div class="scene-label ${labelClass}">${labelText}</div>
                                <div class="scene-text ${labelClass}">"${cena.fala}"</div>
                            </div>
                            <div class="scene-row">
                                <div class="scene-label visual">Visual</div>
                                <div class="scene-text visual">${cena.visual}</div>
                            </div>
                            <div class="scene-time">‚è± ${cena.duracao}s</div>
                        </div>
                    `;
                }
            });

            const formatoLabel = formato === 'script' ? 'S√≥ Script' : formato === 'cenario' ? 'Cen√°rio + Narrativa' : 'Completo';

            return `
                <div class="video-block">
                    <div class="video-header">
                        <span class="video-title">V√≠deo ${video.numero}</span>
                        <span class="video-badge">${duracao}s ‚Ä¢ ${formatoLabel}</span>
                    </div>
                    <div class="video-body">${html}</div>
                </div>
            `;
        }

        function capitalize(s) {
            return s.charAt(0).toUpperCase() + s.slice(1);
        }

        function limparTexto() {
            document.getElementById('inputText').value = '';
            document.getElementById('outputArea').innerHTML = `
                <div class="output-placeholder">
                    <svg viewBox="0 0 24 24"><path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-8 12H9.5v-2H7v-2h2.5V9H11v2h2v2h-2v2zm7-1h-4v-2h4v2zm0-4h-4V8h4v2z"/></svg>
                    <p>Seu roteiro aparecer√° aqui</p>
                </div>
            `;
            document.getElementById('refinePanel').classList.remove('active');
        }

        async function colarTexto() {
            try {
                const texto = await navigator.clipboard.readText();
                document.getElementById('inputText').value = texto;
            } catch (err) {
                alert('N√£o foi poss√≠vel acessar a √°rea de transfer√™ncia');
            }
        }

        function copiarRoteiro() {
            const outputArea = document.getElementById('outputArea');
            const texto = outputArea.innerText;
            if (texto.includes('Seu roteiro aparecer√° aqui')) {
                alert('Gere um roteiro primeiro!');
                return;
            }
            navigator.clipboard.writeText(texto).then(() => {
                alert('Roteiro copiado!');
            });
        }

        // ==================== SISTEMA DE REFINAMENTO ====================

        let refineCount = 0;
        const maxRefines = 3;
        let refineHistory = [];
        let roteiroAtual = null;
        let selectedRefineOption = null;

        const refineConfigs = {
            'mais-curto': {
                label: 'Mais curto',
                aplicar: (roteiro) => {
                    return roteiro.replace(/"([^"]{100,})"/g, (match, texto) => {
                        const palavras = texto.split(' ');
                        if (palavras.length > 15) {
                            return '"' + palavras.slice(0, Math.ceil(palavras.length * 0.7)).join(' ') + '..."';
                        }
                        return match;
                    });
                }
            },
            'mais-longo': { label: 'Mais detalhado', aplicar: (roteiro) => roteiro },
            'mais-informal': {
                label: 'Mais informal',
                aplicar: (roteiro) => roteiro.replace(/voc√™/gi, 'tu').replace(/Olha s√≥/gi, 'Olha s√≥, mano').replace(/Obrigado/gi, 'Valeu')
            },
            'mais-formal': {
                label: 'Mais formal',
                aplicar: (roteiro) => roteiro.replace(/E a√≠/gi, 'Prezados').replace(/Bora/gi, 'Vamos').replace(/tu/gi, 'voc√™')
            },
            'mais-energia': {
                label: 'Mais energia',
                aplicar: (roteiro) => roteiro.replace(/\./g, '!').replace(/!!/g, '!')
            },
            'mais-calmo': {
                label: 'Mais calmo',
                aplicar: (roteiro) => roteiro.replace(/!/g, '.').replace(/VAMOS L√Å/gi, 'Vamos l√°').replace(/ATEN√á√ÉO/gi, 'Aten√ß√£o')
            },
            'mais-vendedor': { label: 'Mais persuasivo', aplicar: (roteiro) => roteiro },
            'mais-educativo': { label: 'Mais educativo', aplicar: (roteiro) => roteiro },
            'gancho-forte': {
                label: 'Gancho mais forte',
                aplicar: (roteiro) => roteiro.replace(/<div class="scene-text hook">"([^"]+)"/, '<div class="scene-text hook">"PARA TUDO! Isso vai mudar completamente a forma como voc√™ v√™ esse assunto..."')
            },
            'cta-forte': {
                label: 'CTA mais forte',
                aplicar: (roteiro) => roteiro.replace(/<div class="scene-text cta">"([^"]+)"/, '<div class="scene-text cta">"Se voc√™ chegou at√© aqui, eu PRECISO que voc√™ fa√ßa isso agora: "')
            },
            'mais-emocional': { label: 'Mais emocional', aplicar: (roteiro) => roteiro },
            'mais-direto': { label: 'Mais direto', aplicar: (roteiro) => roteiro }
        };

        function mostrarPainelRefine() {
            const panel = document.getElementById('refinePanel');
            const outputArea = document.getElementById('outputArea');
            roteiroAtual = outputArea.innerHTML;
            if (!panel.classList.contains('active')) {
                refineCount = 0;
                refineHistory = [];
                updateRefineUI();
            }
            panel.classList.add('active');
        }

        function fecharRefine() {
            document.getElementById('refinePanel').classList.remove('active');
            limparSelecaoRefine();
        }

        function limparSelecaoRefine() {
            document.querySelectorAll('.refine-chip').forEach(chip => chip.classList.remove('selected'));
            document.getElementById('refineCustom').value = '';
            selectedRefineOption = null;
        }

        function updateRefineUI() {
            document.getElementById('refineCount').textContent = refineCount;
            const btn = document.getElementById('btnApplyRefine');
            if (refineCount >= maxRefines) {
                btn.disabled = true;
                btn.innerHTML = 'Limite atingido';
            } else {
                btn.disabled = false;
                btn.innerHTML = `<svg viewBox="0 0 24 24"><path d="M17.65 6.35C16.2 4.9 14.21 4 12 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08c-.82 2.33-3.04 4-5.65 4-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4l-2.35 2.35z"/></svg> Aplicar Melhoria`;
            }

            const historyContainer = document.getElementById('refineHistory');
            const historyList = document.getElementById('refineHistoryList');
            if (refineHistory.length > 0) {
                historyContainer.style.display = 'block';
                historyList.innerHTML = refineHistory.map((item, index) => `
                    <div class="refine-history-item">
                        <div class="refine-history-number">${index + 1}</div>
                        <div class="refine-history-text">${item}</div>
                    </div>
                `).join('');
            } else {
                historyContainer.style.display = 'none';
            }
        }

        async function aplicarRefinamento() {
            if (refineCount >= maxRefines) {
                alert('Voc√™ atingiu o limite de 3 refinamentos para este roteiro.');
                return;
            }

            const customText = document.getElementById('refineCustom').value.trim();
            const outputArea = document.getElementById('outputArea');
            const btn = document.getElementById('btnApplyRefine');
            let descricaoRefinamento = '';

            // Definir tipo de refinamento
            if (selectedRefineOption && refineConfigs[selectedRefineOption]) {
                descricaoRefinamento = refineConfigs[selectedRefineOption].label;
            } else if (customText) {
                descricaoRefinamento = customText.length > 50 ? customText.substring(0, 50) + '...' : customText;
            } else {
                alert('Selecione um tipo de melhoria ou descreva o que deseja ajustar.');
                return;
            }

            // Extrair texto atual do roteiro
            const roteiroTexto = outputArea.innerText;

            // Mostrar loading
            btn.disabled = true;
            btn.innerHTML = '<div class="loading">‚è≥</div> Refinando...';

            const prompt = `Voc√™ √© um roteirista profissional. Refine o roteiro abaixo aplicando a seguinte melhoria:

MELHORIA SOLICITADA: ${selectedRefineOption ? refineConfigs[selectedRefineOption].label : customText}

ROTEIRO ATUAL:
${roteiroTexto}

INSTRU√á√ïES:
1. Aplique APENAS a melhoria solicitada
2. Mantenha a estrutura e formato do roteiro
3. N√£o adicione nem remova cenas, apenas melhore o conte√∫do existente
4. Retorne o roteiro melhorado no mesmo formato JSON:

{
    "videos": [
        {
            "numero": 1,
            "cenas": [
                {
                    "tipo": "gancho|conteudo|cta",
                    "fala": "texto melhorado",
                    "visual": "descri√ß√£o visual",
                    "duracao": 5
                }
            ]
        }
    ]
}`;

            try {
                const resposta = await chamarDeepSeek(prompt);

                let dados;
                try {
                    const jsonLimpo = resposta.replace(/```json\n?/g, '').replace(/```\n?/g, '').trim();
                    dados = JSON.parse(jsonLimpo);
                } catch (e) {
                    throw new Error('Erro ao processar resposta da IA. Tente novamente.');
                }

                // Preservar header atual
                const headerMatch = outputArea.innerHTML.match(/<div class="script-header">[\s\S]*?<\/div>\s*<\/div>/);
                const importantMatch = outputArea.innerHTML.match(/<div class="important-box">[\s\S]*?<\/div>\s*<\/div>/);

                let novoRoteiro = headerMatch ? headerMatch[0] : '';
                if (importantMatch) novoRoteiro += importantMatch[0];

                const formatoSaida = document.getElementById('formatoSaida').value;
                const duracaoVideo = parseInt(document.getElementById('duracaoVideo').value) || 60;

                dados.videos.forEach(video => {
                    novoRoteiro += renderizarVideoIA(video, duracaoVideo, formatoSaida);
                });

                // Adicionar nota de refinamento
                novoRoteiro += `
                    <div class="important-box" style="margin-top: 12px; background: linear-gradient(135deg, rgba(52, 211, 153, 0.15), transparent); border-color: var(--success);">
                        <div class="important-box-title" style="color: var(--success);">‚úì Refinamento #${refineCount + 1} aplicado</div>
                        <div class="important-box-content">${descricaoRefinamento}</div>
                    </div>
                `;

                outputArea.innerHTML = novoRoteiro;

                refineCount++;
                refineHistory.push(descricaoRefinamento);
                roteiroAtual = outputArea.innerHTML;
                updateRefineUI();
                limparSelecaoRefine();

                outputArea.style.transition = 'background 0.3s';
                outputArea.style.background = 'var(--accent-glow)';
                setTimeout(() => { outputArea.style.background = ''; }, 500);

            } catch (error) {
                console.error('Erro:', error);
                alert('Erro ao refinar: ' + error.message);
            } finally {
                btn.disabled = refineCount >= maxRefines;
                if (refineCount >= maxRefines) {
                    btn.innerHTML = 'Limite atingido';
                } else {
                    btn.innerHTML = `<svg viewBox="0 0 24 24"><path d="M17.65 6.35C16.2 4.9 14.21 4 12 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08c-.82 2.33-3.04 4-5.65 4-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4l-2.35 2.35z"/></svg> Aplicar Melhoria`;
                }
            }
        }

        document.querySelectorAll('.refine-chip').forEach(chip => {
            chip.addEventListener('click', function() {
                document.querySelectorAll('.refine-chip').forEach(c => c.classList.remove('selected'));
                this.classList.add('selected');
                selectedRefineOption = this.dataset.refine;
                document.getElementById('refineCustom').value = '';
            });
        });

        document.getElementById('refineCustom').addEventListener('input', function() {
            if (this.value.trim()) {
                document.querySelectorAll('.refine-chip').forEach(c => c.classList.remove('selected'));
                selectedRefineOption = null;
            }
        });
    </script>
</body>
</html>
